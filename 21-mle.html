<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Ocenjivanje metodom maksimalne verodostojnosti | Statistički softver 2</title>
  <meta name="description" content="4 Ocenjivanje metodom maksimalne verodostojnosti | Statistički softver 2" />
  <meta name="generator" content="bookdown 0.9.15 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Ocenjivanje metodom maksimalne verodostojnosti | Statistički softver 2" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Ocenjivanje metodom maksimalne verodostojnosti | Statistički softver 2" />
  
  
  

<meta name="author" content="Blagoje Ivanović" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="12-dplyr.html">
<link rel="next" href="211-em.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.46.1/plotly-latest.min.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-7.0.1/css/motion.css" rel="stylesheet" />
<link href="libs/highcharts-7.0.1/css/htmlwdgtgrid.css" rel="stylesheet" />
<script src="libs/highcharts-7.0.1/highcharts.js"></script>
<script src="libs/highcharts-7.0.1/highcharts-3d.js"></script>
<script src="libs/highcharts-7.0.1/highcharts-more.js"></script>
<script src="libs/highcharts-7.0.1/modules/stock.js"></script>
<script src="libs/highcharts-7.0.1/modules/map.js"></script>
<script src="libs/highcharts-7.0.1/modules/annotations.js"></script>
<script src="libs/highcharts-7.0.1/modules/boost.js"></script>
<script src="libs/highcharts-7.0.1/modules/data.js"></script>
<script src="libs/highcharts-7.0.1/modules/drag-panes.js"></script>
<script src="libs/highcharts-7.0.1/modules/drilldown.js"></script>
<script src="libs/highcharts-7.0.1/modules/item-series.js"></script>
<script src="libs/highcharts-7.0.1/modules/offline-exporting.js"></script>
<script src="libs/highcharts-7.0.1/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-7.0.1/modules/exporting.js"></script>
<script src="libs/highcharts-7.0.1/modules/export-data.js"></script>
<script src="libs/highcharts-7.0.1/modules/funnel.js"></script>
<script src="libs/highcharts-7.0.1/modules/heatmap.js"></script>
<script src="libs/highcharts-7.0.1/modules/treemap.js"></script>
<script src="libs/highcharts-7.0.1/modules/sankey.js"></script>
<script src="libs/highcharts-7.0.1/modules/solid-gauge.js"></script>
<script src="libs/highcharts-7.0.1/modules/streamgraph.js"></script>
<script src="libs/highcharts-7.0.1/modules/sunburst.js"></script>
<script src="libs/highcharts-7.0.1/modules/vector.js"></script>
<script src="libs/highcharts-7.0.1/modules/wordcloud.js"></script>
<script src="libs/highcharts-7.0.1/modules/xrange.js"></script>
<script src="libs/highcharts-7.0.1/modules/tilemap.js"></script>
<script src="libs/highcharts-7.0.1/modules/venn.js"></script>
<script src="libs/highcharts-7.0.1/modules/gantt.js"></script>
<script src="libs/highcharts-7.0.1/modules/timeline.js"></script>
<script src="libs/highcharts-7.0.1/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-7.0.1/plugins/grouped-categories.js"></script>
<script src="libs/highcharts-7.0.1/plugins/motion.js"></script>
<script src="libs/highcharts-7.0.1/plugins/multicolor_series.js"></script>
<script src="libs/highcharts-7.0.1/custom/reset.js"></script>
<script src="libs/highcharts-7.0.1/custom/symbols-extra.js"></script>
<script src="libs/highcharts-7.0.1/custom/text-symbols.js"></script>
<script src="libs/highchart-binding-0.7.0/highchart.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Predgovor</a></li>
<li class="chapter" data-level="1" data-path="11-ggplot.html"><a href="11-ggplot.html"><i class="fa fa-check"></i><b>1</b> Grafički prikaz podataka</a><ul>
<li class="chapter" data-level="1.1" data-path="11-ggplot.html"><a href="11-ggplot.html#uvodni-primeri-i-napomene"><i class="fa fa-check"></i><b>1.1</b> Uvodni primeri i napomene</a></li>
<li class="chapter" data-level="1.2" data-path="11-ggplot.html"><a href="11-ggplot.html#razni-primeri-grafika"><i class="fa fa-check"></i><b>1.2</b> Razni primeri grafika</a><ul>
<li class="chapter" data-level="1.2.1" data-path="11-ggplot.html"><a href="11-ggplot.html#scatterplotovi"><i class="fa fa-check"></i><b>1.2.1</b> Scatterplotovi</a></li>
<li class="chapter" data-level="1.2.2" data-path="11-ggplot.html"><a href="11-ggplot.html#linijski-grafici"><i class="fa fa-check"></i><b>1.2.2</b> Linijski grafici</a></li>
<li class="chapter" data-level="1.2.3" data-path="11-ggplot.html"><a href="11-ggplot.html#histogrami"><i class="fa fa-check"></i><b>1.2.3</b> Histogrami</a></li>
<li class="chapter" data-level="1.2.4" data-path="11-ggplot.html"><a href="11-ggplot.html#crtanje-vise-grafika-odjednom"><i class="fa fa-check"></i><b>1.2.4</b> Crtanje više grafika odjednom</a></li>
<li class="chapter" data-level="1.2.5" data-path="11-ggplot.html"><a href="11-ggplot.html#boks-plotovi"><i class="fa fa-check"></i><b>1.2.5</b> Boks plotovi</a></li>
<li class="chapter" data-level="1.2.6" data-path="11-ggplot.html"><a href="11-ggplot.html#bar-plotovi"><i class="fa fa-check"></i><b>1.2.6</b> Bar plotovi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="115-galerija.html"><a href="115-galerija.html"><i class="fa fa-check"></i><b>2</b> Galerija grafika</a><ul>
<li class="chapter" data-level="" data-path="115-galerija.html"><a href="115-galerija.html#uvod"><i class="fa fa-check"></i>Uvod</a></li>
<li class="chapter" data-level="2.1" data-path="115-galerija.html"><a href="115-galerija.html#ggplot2"><i class="fa fa-check"></i><b>2.1</b> Ggplot2</a><ul>
<li class="chapter" data-level="2.1.1" data-path="115-galerija.html"><a href="115-galerija.html#linijski-grafici-1"><i class="fa fa-check"></i><b>2.1.1</b> Linijski grafici</a></li>
<li class="chapter" data-level="2.1.2" data-path="115-galerija.html"><a href="115-galerija.html#stacked-area-chart"><i class="fa fa-check"></i><b>2.1.2</b> Stacked area chart</a></li>
<li class="chapter" data-level="2.1.3" data-path="115-galerija.html"><a href="115-galerija.html#sezonski-grafik"><i class="fa fa-check"></i><b>2.1.3</b> Sezonski grafik</a></li>
<li class="chapter" data-level="2.1.4" data-path="115-galerija.html"><a href="115-galerija.html#bar-plotovi-1"><i class="fa fa-check"></i><b>2.1.4</b> Bar plotovi</a></li>
<li class="chapter" data-level="2.1.5" data-path="115-galerija.html"><a href="115-galerija.html#lollipop-grafik"><i class="fa fa-check"></i><b>2.1.5</b> Lollipop grafik</a></li>
<li class="chapter" data-level="2.1.6" data-path="115-galerija.html"><a href="115-galerija.html#dumbbell-plot"><i class="fa fa-check"></i><b>2.1.6</b> Dumbbell plot</a></li>
<li class="chapter" data-level="2.1.7" data-path="115-galerija.html"><a href="115-galerija.html#histogram"><i class="fa fa-check"></i><b>2.1.7</b> Histogram</a></li>
<li class="chapter" data-level="2.1.8" data-path="115-galerija.html"><a href="115-galerija.html#grafik-gustine"><i class="fa fa-check"></i><b>2.1.8</b> Grafik gustine</a></li>
<li class="chapter" data-level="2.1.9" data-path="115-galerija.html"><a href="115-galerija.html#boks-plot"><i class="fa fa-check"></i><b>2.1.9</b> Boks plot</a></li>
<li class="chapter" data-level="2.1.10" data-path="115-galerija.html"><a href="115-galerija.html#violinski-grafik"><i class="fa fa-check"></i><b>2.1.10</b> Violinski grafik</a></li>
<li class="chapter" data-level="2.1.11" data-path="115-galerija.html"><a href="115-galerija.html#populaciona-piramida"><i class="fa fa-check"></i><b>2.1.11</b> Populaciona piramida</a></li>
<li class="chapter" data-level="2.1.12" data-path="115-galerija.html"><a href="115-galerija.html#pitica"><i class="fa fa-check"></i><b>2.1.12</b> Pitica</a></li>
<li class="chapter" data-level="2.1.13" data-path="115-galerija.html"><a href="115-galerija.html#hijerarhijski-dendrogram"><i class="fa fa-check"></i><b>2.1.13</b> Hijerarhijski dendrogram</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="1152-plotly.html"><a href="1152-plotly.html"><i class="fa fa-check"></i><b>2.2</b> Plotly</a><ul>
<li class="chapter" data-level="2.2.1" data-path="1152-plotly.html"><a href="1152-plotly.html#scatterplot"><i class="fa fa-check"></i><b>2.2.1</b> Scatterplot</a></li>
<li class="chapter" data-level="2.2.2" data-path="1152-plotly.html"><a href="1152-plotly.html#histogram-i-bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Histogram i Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="1152-plotly.html"><a href="1152-plotly.html#box-plot"><i class="fa fa-check"></i><b>2.2.3</b> Box plot</a></li>
<li class="chapter" data-level="2.2.4" data-path="1152-plotly.html"><a href="1152-plotly.html#pravougaono-naslaganje"><i class="fa fa-check"></i><b>2.2.4</b> Pravougaono naslaganje</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="1153-highcharter.html"><a href="1153-highcharter.html"><i class="fa fa-check"></i><b>2.3</b> Highcharter</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="12-dplyr.html"><a href="12-dplyr.html"><i class="fa fa-check"></i><b>3</b> Rad sa podacima</a><ul>
<li class="chapter" data-level="3.1" data-path="12-dplyr.html"><a href="12-dplyr.html#dataframe"><i class="fa fa-check"></i><b>3.1</b> Dataframe</a></li>
<li class="chapter" data-level="3.2" data-path="12-dplyr.html"><a href="12-dplyr.html#obrada-podataka---dplyr-paket"><i class="fa fa-check"></i><b>3.2</b> Obrada podataka - <code>dplyr</code> paket</a></li>
<li class="chapter" data-level="3.3" data-path="12-dplyr.html"><a href="12-dplyr.html#ucitavanje-eksternih-podataka"><i class="fa fa-check"></i><b>3.3</b> Učitavanje eksternih podataka</a></li>
<li class="chapter" data-level="3.4" data-path="12-dplyr.html"><a href="12-dplyr.html#osnovne-funkcije-paketa-dplyr"><i class="fa fa-check"></i><b>3.4</b> Osnovne funkcije paketa <code>dplyr</code></a><ul>
<li class="chapter" data-level="3.4.1" data-path="12-dplyr.html"><a href="12-dplyr.html#select---odabir-kolona"><i class="fa fa-check"></i><b>3.4.1</b> <code>select</code> - odabir kolona</a></li>
<li class="chapter" data-level="3.4.2" data-path="12-dplyr.html"><a href="12-dplyr.html#filter---filtriranje-redova"><i class="fa fa-check"></i><b>3.4.2</b> <code>filter</code> - Filtriranje redova</a></li>
<li class="chapter" data-level="3.4.3" data-path="12-dplyr.html"><a href="12-dplyr.html#arrange---sortiranje-redova"><i class="fa fa-check"></i><b>3.4.3</b> <code>arrange</code> - sortiranje redova</a></li>
<li class="chapter" data-level="3.4.4" data-path="12-dplyr.html"><a href="12-dplyr.html#mutate---dodavanje-nove-kolone"><i class="fa fa-check"></i><b>3.4.4</b> <code>mutate</code> - dodavanje nove kolone</a></li>
<li class="chapter" data-level="3.4.5" data-path="12-dplyr.html"><a href="12-dplyr.html#summarise---sumarne-statistike"><i class="fa fa-check"></i><b>3.4.5</b> <code>summarise</code> - sumarne statistike</a></li>
<li class="chapter" data-level="3.4.6" data-path="12-dplyr.html"><a href="12-dplyr.html#group_by---grupisanje-opservacija"><i class="fa fa-check"></i><b>3.4.6</b> <code>group_by</code> - grupisanje opservacija</a></li>
<li class="chapter" data-level="3.4.7" data-path="12-dplyr.html"><a href="12-dplyr.html#join---spajanje-tabela"><i class="fa fa-check"></i><b>3.4.7</b> <code>join</code> - spajanje tabela</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="21-mle.html"><a href="21-mle.html"><i class="fa fa-check"></i><b>4</b> Ocenjivanje metodom maksimalne verodostojnosti</a><ul>
<li class="chapter" data-level="4.1" data-path="21-mle.html"><a href="21-mle.html#njutnova-metoda"><i class="fa fa-check"></i><b>4.1</b> Njutnova metoda</a><ul>
<li class="chapter" data-level="4.1.1" data-path="21-mle.html"><a href="21-mle.html#primer-kosijeve-raspodele"><i class="fa fa-check"></i><b>4.1.1</b> Primer Košijeve raspodele</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="211-em.html"><a href="211-em.html"><i class="fa fa-check"></i><b>4.2</b> EM algoritam</a><ul>
<li class="chapter" data-level="4.2.1" data-path="211-em.html"><a href="211-em.html#ocena-parametra-sa-histograma"><i class="fa fa-check"></i><b>4.2.1</b> Ocena parametra sa histograma</a></li>
<li class="chapter" data-level="4.2.2" data-path="211-em.html"><a href="211-em.html#ocenjivanje-mesavine-normalnih-raspodela"><i class="fa fa-check"></i><b>4.2.2</b> Ocenjivanje mešavine normalnih raspodela</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistički softver 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ocenjivanje-metodom-maksimalne-verodostojnosti" class="section level1">
<h1><span class="header-section-number">4</span> Ocenjivanje metodom maksimalne verodostojnosti</h1>
<p>Jedan od najpoznatijih metoda za odredjivanje ocena parametra neke raspodele je upravo metod maksimalne verodostojnosti. On nalazi primenu u svim primenama statistike, od testiranja hipoteza do mašinskog učenja.</p>
<p>Osnovna postavka je sledeća:</p>
<p>Neka je <span class="math inline">\(\mathbf{X}=(X_1, \dots, X_n)\)</span> prost slučajan uzorak sa zajedničkom gustinom (ili zakonom raspodele) <span class="math inline">\(f(\mathbf x;\theta)\)</span> gde je <span class="math inline">\(\theta\)</span> nepoznati parametar. Funkcija verodostojnosti se definiše kao
<span class="math display">\[L(\theta; \mathbf x) = f(\mathbf x;\theta) = \prod_{i=1}^nf(x_i,\theta),\]</span> odnosno funkcija verodostojnosti je zajednička raspodela uzorka, posmatrana kao funkcija parametra <span class="math inline">\(\theta\)</span>. Parametar može biti višedimenzioni (npr. <span class="math inline">\((\mu, \sigma^2)\)</span> kod normalne raspodele), ali ćemo se mi baviti samo jednodimenzionim parametrima u ovom tekstu.</p>
<p>Ocena maksimalne verodostojnosti parametra <span class="math inline">\(\theta\)</span> je <span class="math display">\[\hat{\theta} = \underset{\theta}{\mathrm{argmax}}L(\theta; \mathbf x).\]</span> Dakle ocena metodom maksimalne verodostojnosti je ona vrednosti parametra za koju je funkcija verodostojnosti najveća.</p>
<p>Da bismo našli ovaj maksimum, uglavnom prelazimo na traženje maksimuma logaritma funkcije verodostojnosti koji ima lepši oblik
<span class="math display">\[l(\theta) = \log L(\theta, \mathbf x) = \sum_{i=1}^n\log f(x_i,\theta).\]</span>
Maksimum dalje nalazimo odredjivanjem stacionarne tačke <span class="math inline">\(l(\theta)\)</span>, rešavanjem jednačine <span class="math display">\[\frac{d}{d\theta}l(\theta) = 0.\]</span> U velikom broju slučajeva rešenje ove jednačine, a samim tim i ocena, se može naći analitički, kao u primerima radjenim na matematičkoj statistici, ali nekada rešenje nije dostupno u analitičkom obliku.</p>
<p>U tom slučaju rešenje se mora naći numeričkim metodama. Jedan takav primer raspodele je Košijeva raspodela, koju ćemo koristiti za demonstraciju numeričkih metoda za nalaženje ocena maksimalne verodostojnosti.</p>
<div id="njutnova-metoda" class="section level2">
<h2><span class="header-section-number">4.1</span> Njutnova metoda</h2>
<p>Cilj Njutnove metode je da nadje nulu funkcije <span class="math inline">\(f(x)\)</span>, tj. da nadje rešenje jednačine <span class="math display">\[f(x) = 0.\]</span> Osnovna ideja metode je da se u svakoj iteraciji kriva <span class="math inline">\(y=f(x)\)</span> aproksimira njenom tangentom i nadje nula te tangente, čime se dobija neka aproksimacija nule početne funkcije, sve dok se ne dostigne neki uslov zaustavljanja.</p>
<p>Ako u <span class="math inline">\(n\)</span>-toj iteraciji imamo aproksimaciju nule <span class="math inline">\(x_n\)</span>, novu aproksimaciju <span class="math inline">\(x_{n+1}\)</span> dobijamo na sledeći način:</p>
<ol style="list-style-type: decimal">
<li>Nadjemo tangentu krive <span class="math inline">\(y=f(x)\)</span> u tački <span class="math inline">\(x_n\)</span>, koja ima oblik
<span class="math display">\[y_t = f&#39;(x_n)(x-x_n)+f(x_n).\]</span></li>
<li>Aproksimacija u sledećoj iteraciji, <span class="math inline">\(x_{n+1}\)</span>, je nula te tangente, odnosno rešenje jednačine <span class="math display">\[0 = f&#39;(x_n)(x-x_n)+f(x_n),\]</span> odakle dobijamo <span class="math display">\[x_{n+1} = x_n - \frac{f(x_n)}{f&#39;(x_n)}.\]</span></li>
</ol>
<p>Pseudokod za Njutnovu metodu (nije u R-u!) izgleda ovako:</p>
<pre><code>function njutn(x0, f, df, tol, maxiter) {
  x = x0 - f(x0) / df(x0)
  iter = 1
  
  while (abs(x - x0) &gt; tol) {
    if(iter == maxiter)
      break
    x0 = x
    x = x0 - f(x0) / df(x0)
    iter = iter + 1
  }
  
  return x
}</code></pre>
<div id="primer-kosijeve-raspodele" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Primer Košijeve raspodele</h3>
<p>Primenićemo Njutnovu metodu za nalaženje ocene maksimalne verodostojnosi parametra <span class="math inline">\(\theta\)</span> uzorka iz Košijeve raspodele sa gustinom</p>
<p><span class="math display">\[f(x, \theta)=\frac{1}{\pi}\frac{1}{1+(x-\theta)^2}.\]</span></p>
<p>Generisaćemo uzorak iz Košijeve raspodele za koji ćemo tražiti ocenu parametra.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">21321</span>)
xs &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(<span class="dv">1000</span>, <span class="dt">location =</span> <span class="dv">10</span>)</code></pre>
<p>Logaritam funkcije verodostojnosti je <span class="math display">\[l(\theta) = -\sum_{i=1}^n \log(1+(x_i-\theta)^2) - n\log\pi.\]</span></p>
<p>Definišimo je u R-u.</p>
<pre class="sourceCode r"><code class="sourceCode r">logL &lt;-<span class="st"> </span><span class="cf">function</span>(teta, x) {
  <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>(x<span class="op">-</span>teta)<span class="op">^</span><span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span><span class="kw">length</span>(x)<span class="op">*</span><span class="kw">log</span>(pi)
}</code></pre>
<p>Za naš uzorak ova funkcija izgleda ovako</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Da bismo primenili funkciju curve, moramo prvo vektorizovati logL</span>
vec_logL &lt;-<span class="st"> </span><span class="cf">function</span>(teta_vec, xs) {
  <span class="kw">sapply</span>(teta_vec, logL, xs)
}

<span class="kw">curve</span>(<span class="kw">vec_logL</span>(x, xs), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">30</span>))</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
<p>Izvod logaritma funkcije verodostojnosti je <span class="math display">\[\frac{d}{d\theta}l(\theta) = \sum_{i=1}^n\frac{2(x_i-\theta)}{1+(x_i-\theta)^2}.\]</span></p>
<pre class="sourceCode r"><code class="sourceCode r">dlogL &lt;-<span class="st"> </span><span class="cf">function</span>(teta, x) {
  <span class="kw">sum</span>(<span class="dv">2</span><span class="op">*</span>(x<span class="op">-</span>teta) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">+</span>(x<span class="op">-</span>teta)<span class="op">^</span><span class="dv">2</span>))
}</code></pre>
<p>Izvod izgleda ovako</p>
<pre class="sourceCode r"><code class="sourceCode r">vec_dlogL &lt;-<span class="st"> </span><span class="cf">function</span>(teta_vec, xs) {
  <span class="kw">sapply</span>(teta_vec, dlogL, xs)
}

<span class="kw">curve</span>(<span class="kw">vec_dlogL</span>(x, xs), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">20</span>))</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
<p>A kako smo rekli da je ocena maksimalne verodostojnosti rešenje jednačine <span class="math inline">\(\frac{d}{d\theta}l(\theta) = 0\)</span>, to znači da je ocena upravo nule nacrtane funkcije.</p>
<div id="njutnova-metoda-1" class="section level4">
<h4><span class="header-section-number">4.1.1.1</span> Njutnova metoda</h4>
<p>Primenićemo Njutnovu metodu da nadjemo nulu funkcije <span class="math inline">\(\frac{d}{d\theta}l(\theta)\)</span>.</p>
<p>Za to nam još treba izvod funkcije čiju nulu tražimo, a to je u našem slučaju drugi izvod logaritma funkcije verodostojnosti</p>
<p><span class="math display">\[\frac{d^2}{d\theta^2}l(\theta) = -2\sum_{i=1}^n\frac{1-(x_i-\theta)^2}{(1+(x_i-\theta)^2)^2}.\]</span></p>
<pre class="sourceCode r"><code class="sourceCode r">d2logL &lt;-<span class="st"> </span><span class="cf">function</span>(teta, x) {
  <span class="dv">-2</span><span class="op">*</span><span class="kw">sum</span>((<span class="dv">1</span><span class="op">-</span>(x<span class="op">-</span>teta)<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">+</span>(x<span class="op">-</span>teta)<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span>)
}</code></pre>
<p>Ostaje još samo da implementiramo funkciju koja nalazi nulu funkcije Njutnovom metodom</p>
<pre class="sourceCode r"><code class="sourceCode r">newton &lt;-<span class="st"> </span><span class="cf">function</span>(t0, f, df, <span class="dt">tol=</span><span class="fl">1e-6</span>, <span class="dt">maxiter=</span><span class="dv">100</span>, <span class="dt">trace=</span><span class="ot">FALSE</span>, ...) {
  <span class="cf">if</span> (trace) <span class="kw">print</span>(t0)
  t &lt;-<span class="st"> </span>t0 <span class="op">-</span><span class="st"> </span><span class="kw">f</span>(t0, ...) <span class="op">/</span><span class="st"> </span><span class="kw">df</span>(t0, ...)
  <span class="cf">if</span> (trace) <span class="kw">print</span>(t)
  iter &lt;-<span class="st"> </span><span class="dv">1</span>
  <span class="cf">while</span> (<span class="kw">abs</span>(t <span class="op">-</span><span class="st"> </span>t0) <span class="op">&gt;</span><span class="st"> </span>tol) {
    <span class="cf">if</span>(iter <span class="op">==</span><span class="st"> </span>maxiter)
      <span class="kw">stop</span>(<span class="st">&quot;Max iterations exceeded!&quot;</span>)
    t0 &lt;-<span class="st"> </span>t
    t &lt;-<span class="st"> </span>t0 <span class="op">-</span><span class="st"> </span><span class="kw">f</span>(t0, ...) <span class="op">/</span><span class="st"> </span><span class="kw">df</span>(t0, ...)
    <span class="cf">if</span> (trace) <span class="kw">print</span>(t)
    iter &lt;-<span class="st"> </span>iter <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  }
  <span class="kw">return</span>(t)
}</code></pre>
<p>Na kraju, možemo odrediti ocenu metodom maksimalne verodostojnosti primenom Njutnove metode na izvod logaritma funkcije verodostojnosti</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">newton</span>(<span class="dv">0</span>, dlogL, d2logL, <span class="dt">x =</span> xs, <span class="dt">maxiter=</span><span class="dv">100</span>)</code></pre>
<pre><code>## Error in newton(0, dlogL, d2logL, x = xs, maxiter = 100): Max iterations exceeded!</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># da bi stampali iteracije, dodajte trace=TRUE</span>
<span class="co">#newton(0, dlogL, d2logL, x = xs, maxiter=100, trace=TRUE)</span></code></pre>
<p>Ali avaj! Imamo grešku, algoritam divergira, a vrednosti u iteracijama postaju sve veće.</p>
<p>Razlog za ovo je što smo loše odabrali početnu tačku 0. Njutnova metoda je vrlo osetljiva na odabir početne tačke, pa moramo uzeti neku smisleniju vrednost od koje da krenemo.</p>
<p>Možemo probati razne vrednosti dok ne dobijemo konvergenciju, a možemo i iskoristiti to što je u ovom slučaju <span class="math inline">\(\theta\)</span> parametar položaja, pa možemo pretpostaviti da je u blizini uzoračke sredine ili medijane, pa ćemo probati sa tim vrednostima</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">newton</span>(<span class="kw">mean</span>(xs), dlogL, d2logL, <span class="dt">x =</span> xs, <span class="dt">maxiter=</span><span class="dv">100</span>, <span class="dt">trace=</span><span class="ot">FALSE</span>)</code></pre>
<pre><code>## Error in newton(mean(xs), dlogL, d2logL, x = xs, maxiter = 100, trace = FALSE): Max iterations exceeded!</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">newton</span>(<span class="kw">median</span>(xs), dlogL, d2logL, <span class="dt">x =</span> xs, <span class="dt">maxiter=</span><span class="dv">100</span>, <span class="dt">trace=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## [1] 9.964994
## [1] 9.939758
## [1] 9.939738
## [1] 9.939738</code></pre>
<pre><code>## [1] 9.939738</code></pre>
<p>Za prosek, koji je jednak 14.34 opet divergira algoritam, ali za medijanu koja je manje osetljiva na autlajere, kojih je mnogo zbog težine repova Košijeve raspodele, dobijamo konvergenciju.</p>
<p>Intuitivno, algoritam će u ovom slučaju konvergirati ako za početnu vrednost uzmemo neku vrednosti na padini na grafiku, oko tačke 10, što je prava vrednost parametra.</p>
</div>
<div id="fiserova-modifikacija" class="section level4">
<h4><span class="header-section-number">4.1.1.2</span> Fišerova modifikacija</h4>
<p>Budući da znamo da je Fišerova informaciona funkcija za parametar <span class="math inline">\(\theta\)</span> jednaka <span class="math display">\[\mathbf{I}(\theta) =-E\left(\frac{d^2}{d\theta^2}\log L(\theta; \mathbf{x})\right) = \frac n2,\]</span> možemo je iskoristiti (sa znakom minusa) umesto drugog izvoda logaritma funkcije verodostojnosti, čime dobijamo Fišerovu modifikaciju Njutnovog metoda. Dakle, osnovna ideja je da umesto drugog izvoda koristimo očekivanje drugog izvoda, čime “uprosečujemo” uticaj uzorka na drugi izvod, pa dobijamo funkciju samo od parametra.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fiserov &quot;drugi izvod&quot;</span>
fishd2logL &lt;-<span class="st"> </span><span class="cf">function</span>(teta, x) {
  <span class="op">-</span><span class="st"> </span><span class="kw">length</span>(x) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
}

<span class="kw">newton</span>(<span class="kw">median</span>(xs), dlogL, fishd2logL, <span class="dt">x =</span> xs, <span class="dt">maxiter=</span><span class="dv">100</span>, <span class="dt">trace=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## [1] 9.964994
## [1] 9.939801
## [1] 9.939738
## [1] 9.939738</code></pre>
<pre><code>## [1] 9.939738</code></pre>
<p>Ako krenemo od medijane dobijamo istu vrednost kao za Njutnovu metodu. Medjutim, prednost Fišerove modifikacije je u tome što je manje osetljiva na odabir početne tačke. Na primer, Njutnova metoda je divergirala kad uzmemo prosek, ali Fišerova nalazi tačno rešenje:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">newton</span>(<span class="kw">mean</span>(xs), dlogL, fishd2logL, <span class="dt">x =</span> xs, <span class="dt">maxiter=</span><span class="dv">100</span>, <span class="dt">trace=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## [1] 14.34473
## [1] 13.6144
## [1] 12.79706
## [1] 11.88649
## [1] 10.89827
## [1] 10.1139
## [1] 9.940372
## [1] 9.93974
## [1] 9.939738
## [1] 9.939738</code></pre>
<pre><code>## [1] 9.939738</code></pre>
<p>Fišerova metoda radi čak i ako krenemo od nule, koja je daleko od pravog rešenja.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">newton</span>(<span class="dv">0</span>, dlogL, fishd2logL, <span class="dt">x =</span> xs, <span class="dt">maxiter=</span><span class="dv">100</span>, <span class="dt">trace=</span><span class="ot">TRUE</span>)</code></pre>
<pre><code>## [1] 0
## [1] 0.3896712
## [1] 0.7888266
## [1] 1.201395
## [1] 1.629696
## [1] 2.073622
## [1] 2.534672
## [1] 3.017656
## [1] 3.527813
## [1] 4.069456
## [1] 4.651676
## [1] 5.283916
## [1] 5.973198
## [1] 6.735188
## [1] 7.597059
## [1] 8.568795
## [1] 9.511005
## [1] 9.91561
## [1] 9.939628
## [1] 9.939738
## [1] 9.939738</code></pre>
<pre><code>## [1] 9.939738</code></pre>
<p>Možemo primetiti da imamo dosta više iteracija u Fišerovoj verziji, što je mana ove metode u odnosu na Njutnovu, koja brže konvergira (ukoliko konvergira).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="12-dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="211-em.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
