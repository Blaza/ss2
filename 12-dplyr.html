<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Rad sa podacima | Statistički softver 2</title>
  <meta name="description" content="3 Rad sa podacima | Statistički softver 2" />
  <meta name="generator" content="bookdown  and GitBook 2.6.7" />

  <meta property="og:title" content="3 Rad sa podacima | Statistički softver 2" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Rad sa podacima | Statistički softver 2" />
  
  
  

<meta name="author" content="Blagoje Ivanović" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="1153-highcharter.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-7.0.1/css/motion.css" rel="stylesheet" />
<link href="libs/highcharts-7.0.1/css/htmlwdgtgrid.css" rel="stylesheet" />
<script src="libs/highcharts-7.0.1/highcharts.js"></script>
<script src="libs/highcharts-7.0.1/highcharts-3d.js"></script>
<script src="libs/highcharts-7.0.1/highcharts-more.js"></script>
<script src="libs/highcharts-7.0.1/modules/stock.js"></script>
<script src="libs/highcharts-7.0.1/modules/map.js"></script>
<script src="libs/highcharts-7.0.1/modules/annotations.js"></script>
<script src="libs/highcharts-7.0.1/modules/boost.js"></script>
<script src="libs/highcharts-7.0.1/modules/data.js"></script>
<script src="libs/highcharts-7.0.1/modules/drag-panes.js"></script>
<script src="libs/highcharts-7.0.1/modules/drilldown.js"></script>
<script src="libs/highcharts-7.0.1/modules/item-series.js"></script>
<script src="libs/highcharts-7.0.1/modules/offline-exporting.js"></script>
<script src="libs/highcharts-7.0.1/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-7.0.1/modules/exporting.js"></script>
<script src="libs/highcharts-7.0.1/modules/export-data.js"></script>
<script src="libs/highcharts-7.0.1/modules/funnel.js"></script>
<script src="libs/highcharts-7.0.1/modules/heatmap.js"></script>
<script src="libs/highcharts-7.0.1/modules/treemap.js"></script>
<script src="libs/highcharts-7.0.1/modules/sankey.js"></script>
<script src="libs/highcharts-7.0.1/modules/solid-gauge.js"></script>
<script src="libs/highcharts-7.0.1/modules/streamgraph.js"></script>
<script src="libs/highcharts-7.0.1/modules/sunburst.js"></script>
<script src="libs/highcharts-7.0.1/modules/vector.js"></script>
<script src="libs/highcharts-7.0.1/modules/wordcloud.js"></script>
<script src="libs/highcharts-7.0.1/modules/xrange.js"></script>
<script src="libs/highcharts-7.0.1/modules/tilemap.js"></script>
<script src="libs/highcharts-7.0.1/modules/venn.js"></script>
<script src="libs/highcharts-7.0.1/modules/gantt.js"></script>
<script src="libs/highcharts-7.0.1/modules/timeline.js"></script>
<script src="libs/highcharts-7.0.1/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-7.0.1/plugins/grouped-categories.js"></script>
<script src="libs/highcharts-7.0.1/plugins/motion.js"></script>
<script src="libs/highcharts-7.0.1/plugins/multicolor_series.js"></script>
<script src="libs/highcharts-7.0.1/custom/reset.js"></script>
<script src="libs/highcharts-7.0.1/custom/symbols-extra.js"></script>
<script src="libs/highcharts-7.0.1/custom/text-symbols.js"></script>
<script src="libs/highchart-binding-0.7.0/highchart.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Predgovor</a></li>
<li class="chapter" data-level="1" data-path="11-ggplot.html"><a href="11-ggplot.html"><i class="fa fa-check"></i><b>1</b> Grafički prikaz podataka</a><ul>
<li class="chapter" data-level="1.1" data-path="11-ggplot.html"><a href="11-ggplot.html#uvodni-primeri-i-napomene"><i class="fa fa-check"></i><b>1.1</b> Uvodni primeri i napomene</a></li>
<li class="chapter" data-level="1.2" data-path="11-ggplot.html"><a href="11-ggplot.html#razni-primeri-grafika"><i class="fa fa-check"></i><b>1.2</b> Razni primeri grafika</a><ul>
<li class="chapter" data-level="1.2.1" data-path="11-ggplot.html"><a href="11-ggplot.html#scatterplotovi"><i class="fa fa-check"></i><b>1.2.1</b> Scatterplotovi</a></li>
<li class="chapter" data-level="1.2.2" data-path="11-ggplot.html"><a href="11-ggplot.html#linijski-grafici"><i class="fa fa-check"></i><b>1.2.2</b> Linijski grafici</a></li>
<li class="chapter" data-level="1.2.3" data-path="11-ggplot.html"><a href="11-ggplot.html#histogrami"><i class="fa fa-check"></i><b>1.2.3</b> Histogrami</a></li>
<li class="chapter" data-level="1.2.4" data-path="11-ggplot.html"><a href="11-ggplot.html#crtanje-vise-grafika-odjednom"><i class="fa fa-check"></i><b>1.2.4</b> Crtanje više grafika odjednom</a></li>
<li class="chapter" data-level="1.2.5" data-path="11-ggplot.html"><a href="11-ggplot.html#boks-plotovi"><i class="fa fa-check"></i><b>1.2.5</b> Boks plotovi</a></li>
<li class="chapter" data-level="1.2.6" data-path="11-ggplot.html"><a href="11-ggplot.html#bar-plotovi"><i class="fa fa-check"></i><b>1.2.6</b> Bar plotovi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="115-galerija.html"><a href="115-galerija.html"><i class="fa fa-check"></i><b>2</b> Galerija grafika</a><ul>
<li class="chapter" data-level="" data-path="115-galerija.html"><a href="115-galerija.html#uvod"><i class="fa fa-check"></i>Uvod</a></li>
<li class="chapter" data-level="2.1" data-path="115-galerija.html"><a href="115-galerija.html#ggplot2"><i class="fa fa-check"></i><b>2.1</b> Ggplot2</a><ul>
<li class="chapter" data-level="2.1.1" data-path="115-galerija.html"><a href="115-galerija.html#linijski-grafici-1"><i class="fa fa-check"></i><b>2.1.1</b> Linijski grafici</a></li>
<li class="chapter" data-level="2.1.2" data-path="115-galerija.html"><a href="115-galerija.html#stacked-area-chart"><i class="fa fa-check"></i><b>2.1.2</b> Stacked area chart</a></li>
<li class="chapter" data-level="2.1.3" data-path="115-galerija.html"><a href="115-galerija.html#sezonski-grafik"><i class="fa fa-check"></i><b>2.1.3</b> Sezonski grafik</a></li>
<li class="chapter" data-level="2.1.4" data-path="115-galerija.html"><a href="115-galerija.html#bar-plotovi-1"><i class="fa fa-check"></i><b>2.1.4</b> Bar plotovi</a></li>
<li class="chapter" data-level="2.1.5" data-path="115-galerija.html"><a href="115-galerija.html#lollipop-grafik"><i class="fa fa-check"></i><b>2.1.5</b> Lollipop grafik</a></li>
<li class="chapter" data-level="2.1.6" data-path="115-galerija.html"><a href="115-galerija.html#dumbbell-plot"><i class="fa fa-check"></i><b>2.1.6</b> Dumbbell plot</a></li>
<li class="chapter" data-level="2.1.7" data-path="115-galerija.html"><a href="115-galerija.html#histogram"><i class="fa fa-check"></i><b>2.1.7</b> Histogram</a></li>
<li class="chapter" data-level="2.1.8" data-path="115-galerija.html"><a href="115-galerija.html#grafik-gustine"><i class="fa fa-check"></i><b>2.1.8</b> Grafik gustine</a></li>
<li class="chapter" data-level="2.1.9" data-path="115-galerija.html"><a href="115-galerija.html#boks-plot"><i class="fa fa-check"></i><b>2.1.9</b> Boks plot</a></li>
<li class="chapter" data-level="2.1.10" data-path="115-galerija.html"><a href="115-galerija.html#violinski-grafik"><i class="fa fa-check"></i><b>2.1.10</b> Violinski grafik</a></li>
<li class="chapter" data-level="2.1.11" data-path="115-galerija.html"><a href="115-galerija.html#populaciona-piramida"><i class="fa fa-check"></i><b>2.1.11</b> Populaciona piramida</a></li>
<li class="chapter" data-level="2.1.12" data-path="115-galerija.html"><a href="115-galerija.html#pitica"><i class="fa fa-check"></i><b>2.1.12</b> Pitica</a></li>
<li class="chapter" data-level="2.1.13" data-path="115-galerija.html"><a href="115-galerija.html#hijerarhijski-dendrogram"><i class="fa fa-check"></i><b>2.1.13</b> Hijerarhijski dendrogram</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="1152-plotly.html"><a href="1152-plotly.html"><i class="fa fa-check"></i><b>2.2</b> Plotly</a><ul>
<li class="chapter" data-level="2.2.1" data-path="1152-plotly.html"><a href="1152-plotly.html#scatterplot"><i class="fa fa-check"></i><b>2.2.1</b> Scatterplot</a></li>
<li class="chapter" data-level="2.2.2" data-path="1152-plotly.html"><a href="1152-plotly.html#histogram-i-bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Histogram i Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="1152-plotly.html"><a href="1152-plotly.html#box-plot"><i class="fa fa-check"></i><b>2.2.3</b> Box plot</a></li>
<li class="chapter" data-level="2.2.4" data-path="1152-plotly.html"><a href="1152-plotly.html#pravougaono-naslaganje"><i class="fa fa-check"></i><b>2.2.4</b> Pravougaono naslaganje</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="1153-highcharter.html"><a href="1153-highcharter.html"><i class="fa fa-check"></i><b>2.3</b> Highcharter</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="12-dplyr.html"><a href="12-dplyr.html"><i class="fa fa-check"></i><b>3</b> Rad sa podacima</a><ul>
<li class="chapter" data-level="3.1" data-path="12-dplyr.html"><a href="12-dplyr.html#dataframe"><i class="fa fa-check"></i><b>3.1</b> Dataframe</a></li>
<li class="chapter" data-level="3.2" data-path="12-dplyr.html"><a href="12-dplyr.html#obrada-podataka---dplyr-paket"><i class="fa fa-check"></i><b>3.2</b> Obrada podataka - <code>dplyr</code> paket</a><ul>
<li class="chapter" data-level="3.2.1" data-path="12-dplyr.html"><a href="12-dplyr.html#ucitavanje-eksternih-podataka"><i class="fa fa-check"></i><b>3.2.1</b> Učitavanje eksternih podataka</a></li>
<li class="chapter" data-level="3.2.2" data-path="12-dplyr.html"><a href="12-dplyr.html#osnovne-funkcije-paketa-dplyr"><i class="fa fa-check"></i><b>3.2.2</b> Osnovne funkcije paketa <code>dplyr</code></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistički softver 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rad-sa-podacima" class="section level1">
<h1><span class="header-section-number">3</span> Rad sa podacima</h1>
<p>U ovom poglavlju ćemo se upoznati sa osnovnim metodama rada sa podacima, prvenstveno kroz paket <code>dplyr</code>, koji je jedan od najkorišćenijih paketa u R-u. Pre upoznavanja sa tim paketom, osnvrnućemo se na osnovnu strukturu podataka u R-u, dataframe, koja se koristi za rad sa tabelarnim podacima.</p>
<div id="dataframe" class="section level2">
<h2><span class="header-section-number">3.1</span> Dataframe</h2>
<p>Dataframe je najčešći način čuvanja podataka u R-u i vrlo je pogodan za rad i analizu. Služi za prikaz tabelarnih podataka, pa liči na matricu, s tim što je dataframe u snovi lista koja sadrži vektore jednakih dužina (kolone), pri čemu ti vektori ne moraju biti istog tipa. Dakle možemo imati jednu kolonu koju čine brojevi, a drugu tekstualni podaci.</p>
<p>Dataframe se pravi na sledeći način:</p>
<pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">kolona2 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi&quot;</span>, <span class="st">&quot;drugi&quot;</span>, <span class="st">&quot;treci&quot;</span>))
df</code></pre>
<pre><code>##   kolona1 kolona2
## 1       1    prvi
## 2       2   drugi
## 3       3   treci</code></pre>
<p>Ovako smo dobili dataframe sa dve kolone, od kojih je jedna numeri;ka a druga tekstualna.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(df)</code></pre>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  2 variables:
##  $ kolona1: num  1 2 3
##  $ kolona2: Factor w/ 3 levels &quot;drugi&quot;,&quot;prvi&quot;,..: 2 1 3</code></pre>
<p>R podrazumevano pretvara tekstualne podatke u faktore, to možemo preduprediti ako dodamo argument <code>stringsAsFactors = FALSE</code></p>
<pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">kolona2 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi&quot;</span>, <span class="st">&quot;drugi&quot;</span>, <span class="st">&quot;treci&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">str</span>(df)</code></pre>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  2 variables:
##  $ kolona1: num  1 2 3
##  $ kolona2: chr  &quot;prvi&quot; &quot;drugi&quot; &quot;treci&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df</code></pre>
<pre><code>##   kolona1 kolona2
## 1       1    prvi
## 2       2   drugi
## 3       3   treci</code></pre>
<p>Dva dataframe-a (koji imaju isi broj kolona) se mogu spojiti da dobijemo više kolona korišćenjem funkcije <code>cbind</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">kolona2 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi&quot;</span>, <span class="st">&quot;drugi&quot;</span>, <span class="st">&quot;treci&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona3 =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="dt">kolona4 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi1&quot;</span>, <span class="st">&quot;drugi1&quot;</span>, <span class="st">&quot;treci1&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
df3 &lt;-<span class="st"> </span><span class="kw">cbind</span>(df1, df2)
df3</code></pre>
<pre><code>##   kolona1 kolona2 kolona3 kolona4
## 1       1    prvi       4   prvi1
## 2       2   drugi       5  drugi1
## 3       3   treci       6  treci1</code></pre>
<p>Takodje, mogu se nadovezati po vrstama (ako imaju ista imena kolona) funkcijom <code>rbind</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">kolona2 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi&quot;</span>, <span class="st">&quot;drugi&quot;</span>, <span class="st">&quot;treci&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona1 =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="dt">kolona2 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi1&quot;</span>, <span class="st">&quot;drugi1&quot;</span>, <span class="st">&quot;treci1&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
df4 &lt;-<span class="st"> </span><span class="kw">rbind</span>(df1, df2)
df4</code></pre>
<pre><code>##   kolona1 kolona2
## 1       1    prvi
## 2       2   drugi
## 3       3   treci
## 4       4   prvi1
## 5       5  drugi1
## 6       6  treci1</code></pre>
<p>Vrednostima kolona možemo pristupati pomoću operatora <code>$</code>, kao u listama, a istim možemo i dodati nove kolone.</p>
<pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>kolona1</code></pre>
<pre><code>## [1] 1 2 3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>kolona5 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)
df</code></pre>
<pre><code>##   kolona1 kolona2 kolona5
## 1       1    prvi       7
## 2       2   drugi       8
## 3       3   treci       9</code></pre>
<p>Medjutim, možda elegantniji način filtriranja i odabira podskupova dataframe-a je korišćenjem uglatih zagrada. Koristimo notaciju <code>df[redovi, kolone]</code>, gde prvim argumentom odredjujemo koje redove želimo da uzmemo, a drugim koje kolone. Prazno mesto za neki od argumenata znači “uzmi sve”.</p>
<pre class="sourceCode r"><code class="sourceCode r">df[,] <span class="co"># sve</span></code></pre>
<pre><code>##   kolona1 kolona2 kolona5
## 1       1    prvi       7
## 2       2   drugi       8
## 3       3   treci       9</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df[<span class="dv">1</span>,] <span class="co"># prva vrsta</span></code></pre>
<pre><code>##   kolona1 kolona2 kolona5
## 1       1    prvi       7</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df[,<span class="dv">1</span>] <span class="co"># prva kolona</span></code></pre>
<pre><code>## [1] 1 2 3</code></pre>
<p>Redovi mogu biti ili vektori brojeva koji označavaju indekse redova koje da uzmemo, ili vektori TRUE/FALSE vrednosti iste dužine kao broj vrsta u dataframe-u, pri čemu se tada biraju redovi na pozicijama gde je u vektoru vrednost TRUE.</p>
<pre class="sourceCode r"><code class="sourceCode r">df4[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>), ] <span class="co"># sve kolone, redovi 1,3,4</span></code></pre>
<pre><code>##   kolona1 kolona2
## 1       1    prvi
## 3       3   treci
## 4       4   prvi1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df4[df4<span class="op">$</span>kolona1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>, ] <span class="co"># sve kolone, one vrste kod kojih je kolona1 veca od 3</span></code></pre>
<pre><code>##   kolona1 kolona2
## 4       4   prvi1
## 5       5  drugi1
## 6       6  treci1</code></pre>
<p>Kolone mogu biti ili vektori brojeva koji označavaju koje kolone da uzmemo prema indeksu, ili vektori stringova, koji označavaju imena kolona koje da uzmemo.</p>
<pre class="sourceCode r"><code class="sourceCode r">df3[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)] <span class="co"># sve vrste, 1 i 3 kolona</span></code></pre>
<pre><code>##   kolona1 kolona3
## 1       1       4
## 2       2       5
## 3       3       6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df3[, <span class="kw">c</span>(<span class="st">&quot;kolona1&quot;</span>, <span class="st">&quot;kolona3&quot;</span>)] <span class="co"># isto</span></code></pre>
<pre><code>##   kolona1 kolona3
## 1       1       4
## 2       2       5
## 3       3       6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df3[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="st">&quot;kolona1&quot;</span>, <span class="st">&quot;kolona3&quot;</span>)] <span class="co"># prvi i treci red, prva i treca kolona</span></code></pre>
<pre><code>##   kolona1 kolona3
## 1       1       4
## 3       3       6</code></pre>
<p>Korisna stvar je da ako koristimo vektore brojeva za indeksiranje, ukoliko stavimo znak <code>-</code> ispred, to znači da izuzimamo te redove/kolone.</p>
<pre class="sourceCode r"><code class="sourceCode r">df[, <span class="dv">-1</span>] <span class="co"># sve bez prve kolone</span></code></pre>
<pre><code>##   kolona2 kolona5
## 1    prvi       7
## 2   drugi       8
## 3   treci       9</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df[<span class="op">-</span><span class="dv">2</span>, ] <span class="co"># sve bez druge vrste</span></code></pre>
<pre><code>##   kolona1 kolona2 kolona5
## 1       1    prvi       7
## 3       3   treci       9</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="st">&quot;kolona2&quot;</span>, <span class="st">&quot;kolona5&quot;</span>)] <span class="co"># druga i peta kolona, bez prve i druge vrste</span></code></pre>
<pre><code>##   kolona2 kolona5
## 3   treci       9</code></pre>
<p>Konačno, za osnovne informacije o tabeli postoje funkcije <code>colnames</code>, <code>rownames</code>, <code>ncol</code> i <code>nrow</code>, za koje možete pretpostaviti šta rade.</p>
</div>
<div id="obrada-podataka---dplyr-paket" class="section level2">
<h2><span class="header-section-number">3.2</span> Obrada podataka - <code>dplyr</code> paket</h2>
<p>Prethodno navedeni način rada sa tabelarnim podacima učitanim kao dataframe može postati prilično nezgrapan kod komplikovanijih zahteva, pa je stoga smišljen mnogo elegantniji pristup pomoću paketa <code>dplyr</code>. Uvodni tutorijal za paket možete naći i na <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html" class="uri">https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html</a>.</p>
<p>Zansnovan je na korišćenju nekoliko osnovnih radnji koje se primenjuju na podacima, koje su implementirane funkcijama:</p>
<ul>
<li><code>select</code> - biranje kolona iz tabele</li>
<li><code>filter</code> - filtriranje vrsta tabele</li>
<li><code>arrange</code> - sortiranje vrsta na osnovu nekih kolona</li>
<li><code>mutate</code> - pravljenje novih kolona korišćenjem postojećih</li>
<li><code>summarise</code> - računanje neke sumarne statistike (grupisanih) podataka</li>
</ul>
<p>Postoji i mnogo više funkcija u ovom paketu, koje su često slične navedenim i koje ćemo kad za to bude potrebe pokazati.</p>
<p>Uz ovaj paket se upotrebljava malo čunija sintaksa, zasnovana na korišćenju operatora kompozicije <code>%&gt;%</code>. Najlakše ćemo pokazati primerom šta on radi.</p>
<p>Uzmimo pomoću paketa <code>dplyr</code> kolonu 1 iz našeg dataframe-a.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(kolona1)</code></pre>
<pre><code>##   kolona1
## 1       1
## 2       2
## 3       3</code></pre>
<p>Ovo je ekvivalentno pozivu</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(df, kolona1)</code></pre>
<pre><code>##   kolona1
## 1       1
## 2       2
## 3       3</code></pre>
<p>Operator <code>%&gt;%</code> radi tako što prosledjuje levi operand kao prvi argument funkcije date sa desne strane operatora, pa ostale argumente prosledjuje kao dodatne. Suštinski, kod <code>x %&gt;% f(y)</code> postaje <code>f(x, y)</code>. Ako želimo da specifikujemo gde hoćemo da stavimo levu stranu operatora, koristimo <code>.</code>. Na primer, gornji kod je ekvivalentan</p>
<pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(., kolona1)</code></pre>
<pre><code>##   kolona1
## 1       1
## 2       2
## 3       3</code></pre>
<p>Vremenom će postati ovakva sintaksa prirodna. Vrlo je elegantna jer omogućava jednostavno nadovezivanje. Na sledeći način iz <code>df</code> izaberemo prve dve kolone i filtriramo da uzmemo vrste gde je prva kolona veća od 1.</p>
<pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(kolona1, kolona2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(kolona1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</code></pre>
<pre><code>##   kolona1 kolona2
## 1       2   drugi
## 2       3   treci</code></pre>
<p>Ovime smo videli već primere korišćenja dve funkcije u <code>dplyr</code> paketu - <code>select</code> i <code>filter</code>.</p>
<div id="ucitavanje-eksternih-podataka" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Učitavanje eksternih podataka</h3>
<p>Prikažimo mogućnosti paketa <code>dplyr</code> kroz istraživanje podataka o životnom veku u državama, poteklih od Svetske zdravstvene organizacije. Podaci koje ćemo posmatrati su dostupni na <a href="https://www.kaggle.com/kumarajarshi/life-expectancy-who" class="uri">https://www.kaggle.com/kumarajarshi/life-expectancy-who</a>.</p>
<p>Kada preuzmemo podatke, učitavamo ih funkcijom <code>read.csv</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">who_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Life Expectancy Data.csv&quot;</span>)
who_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">15</span>) <span class="co"># stampamo 15 slucajno izabranih</span></code></pre>
<pre><code>##                     Country Year     Status Life.expectancy
## 1     Sao Tome and Principe 2010 Developing            66.2
## 2                 Mauritius 2006 Developing            71.8
## 3                   Senegal 2012 Developing            65.6
## 4                Azerbaijan 2002 Developing            67.8
## 5                  Slovenia 2011  Developed            79.8
## 6                  Maldives 2014 Developing            78.2
## 7                   Estonia 2005 Developing            72.8
## 8             Côte d&#39;Ivoire 2000 Developing            47.9
## 9  Central African Republic 2003 Developing            45.7
## 10                   Guyana 2008 Developing            66.3
## 11                Swaziland 2008 Developing            51.4
## 12                  Myanmar 2007 Developing            64.5
## 13                 Cameroon 2015 Developing            57.3
## 14                Australia 2001  Developed            79.9
## 15                   Gambia 2012 Developing            62.0
##    Adult.Mortality infant.deaths Alcohol percentage.expenditure
## 1               24             0    5.58             63.0403268
## 2              165             0    3.73            502.3844946
## 3                2            20    0.28             10.2065946
## 4              146             7    0.55             39.3325369
## 5               84             0   10.61           3343.0262190
## 6               62             0    0.01           2051.7486150
## 7              189             0   15.52            153.5045263
## 8              461            67    3.45              0.0000000
## 9               51            17    1.49             46.1161944
## 10             218             1    7.32            493.3279293
## 11             477             3    4.87            413.0063027
## 12             217            58    0.26              0.5305728
## 13             357            45      NA              0.0000000
## 14              75             1    9.53           3064.3011440
## 15             269             3    0.01              0.0000000
##    Hepatitis.B Measles  BMI under.five.deaths Polio Total.expenditure
## 1           98       0 26.9                 0    98              5.24
## 2           97       3 28.6                 0    98              4.38
## 3           91      46 22.7                29    83              4.31
## 4            5    4353 43.1                 9     8              4.47
## 5           NA      22 57.6                 0    96              9.80
## 6           99       0 26.2                 0    99             13.73
## 7           95       2 55.5                 0    96              5.20
## 8           NA    5729 19.4                95    66              6.00
## 9           NA     652 17.5                26    44              4.31
## 10          93       0  4.9                 1    93              7.46
## 11           9       1 28.9                 4    89              8.19
## 12          85    1088 17.6                78    84              1.68
## 13          84    1809 29.0                68    83                NA
## 14          94     141 59.0                 2    91              8.18
## 15          98       0 25.4                 5    98              6.12
##    Diphtheria HIV.AIDS        GDP Population thinness..1.19.years
## 1          98      0.5  1129.7550     174776                  6.1
## 2          97      0.1  5695.9693    1233996                  7.6
## 3          91      0.4   136.4518    1373513                  1.0
## 4          76      0.1   763.7386     817195                  3.1
## 5          96      0.1 24985.2483     252843                  1.6
## 6          99      0.1  7716.2415         41                 13.6
## 7          96      0.1  1338.3132    1354775                  2.1
## 8          65      7.1         NA         NA                  8.1
## 9          47     12.8   286.2582    3981665                  1.0
## 10         93      0.8  2576.1250     746314                  5.6
## 11         88     40.2  2842.4384    1158897                  6.1
## 12         86      0.6    41.4510   49171586                 13.2
## 13         84      3.5  1244.4294   22834522                  5.6
## 14         92      0.1 19517.8417      19413                  0.7
## 15         98      1.4         NA         NA                  7.8
##    thinness.5.9.years Income.composition.of.resources Schooling
## 1                 6.0                           0.542      10.6
## 2                 7.5                           0.713      13.4
## 3                 9.9                           0.463       8.3
## 4                 3.1                           0.651      10.6
## 5                 1.6                           0.876      17.0
## 6                13.7                           0.693      12.7
## 7                 2.2                           0.812      15.9
## 8                 8.1                              NA        NA
## 9                 1.1                           0.316       5.6
## 10                5.4                           0.618      10.7
## 11                6.3                           0.514      10.6
## 12               13.5                           0.484       8.1
## 13                5.5                           0.514      10.4
## 14                0.7                           0.899      20.5
## 15                7.7                           0.440       8.8</code></pre>
<p>Paket <code>dplyr</code> koristi malo bogatiju strukturu umesto dataframe-a za tabelarne podatke, a to je tibble. Podatke pretvaramo u taj format na sledeći način:</p>
<pre class="sourceCode r"><code class="sourceCode r">who_data &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(who_data)
who_data</code></pre>
<pre><code>## # A tibble: 2,938 x 22
##    Country  Year Status Life.expectancy Adult.Mortality infant.deaths
##    &lt;fct&gt;   &lt;int&gt; &lt;fct&gt;            &lt;dbl&gt;           &lt;int&gt;         &lt;int&gt;
##  1 Afghan…  2015 Devel…            65               263            62
##  2 Afghan…  2014 Devel…            59.9             271            64
##  3 Afghan…  2013 Devel…            59.9             268            66
##  4 Afghan…  2012 Devel…            59.5             272            69
##  5 Afghan…  2011 Devel…            59.2             275            71
##  6 Afghan…  2010 Devel…            58.8             279            74
##  7 Afghan…  2009 Devel…            58.6             281            77
##  8 Afghan…  2008 Devel…            58.1             287            80
##  9 Afghan…  2007 Devel…            57.5             295            82
## 10 Afghan…  2006 Devel…            57.3             295            84
## # … with 2,928 more rows, and 16 more variables: Alcohol &lt;dbl&gt;,
## #   percentage.expenditure &lt;dbl&gt;, Hepatitis.B &lt;int&gt;, Measles &lt;int&gt;,
## #   BMI &lt;dbl&gt;, under.five.deaths &lt;int&gt;, Polio &lt;int&gt;,
## #   Total.expenditure &lt;dbl&gt;, Diphtheria &lt;int&gt;, HIV.AIDS &lt;dbl&gt;, GDP &lt;dbl&gt;,
## #   Population &lt;dbl&gt;, thinness..1.19.years &lt;dbl&gt;,
## #   thinness.5.9.years &lt;dbl&gt;, Income.composition.of.resources &lt;dbl&gt;,
## #   Schooling &lt;dbl&gt;</code></pre>
<p>Vidimo blage razlike u prikazu.</p>
<p>Korisno je pogledati podatke funkcijom <code>glimpse</code> (iz <code>dplyr</code>), gde vidimo tip promenljivih i prvih nekoliko podataka iz odgovarajuće kolone.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(who_data)</code></pre>
<pre><code>## Observations: 2,938
## Variables: 22
## $ Country                         &lt;fct&gt; Afghanistan, Afghanistan, Afghan…
## $ Year                            &lt;int&gt; 2015, 2014, 2013, 2012, 2011, 20…
## $ Status                          &lt;fct&gt; Developing, Developing, Developi…
## $ Life.expectancy                 &lt;dbl&gt; 65.0, 59.9, 59.9, 59.5, 59.2, 58…
## $ Adult.Mortality                 &lt;int&gt; 263, 271, 268, 272, 275, 279, 28…
## $ infant.deaths                   &lt;int&gt; 62, 64, 66, 69, 71, 74, 77, 80, …
## $ Alcohol                         &lt;dbl&gt; 0.01, 0.01, 0.01, 0.01, 0.01, 0.…
## $ percentage.expenditure          &lt;dbl&gt; 71.279624, 73.523582, 73.219243,…
## $ Hepatitis.B                     &lt;int&gt; 65, 62, 64, 67, 68, 66, 63, 64, …
## $ Measles                         &lt;int&gt; 1154, 492, 430, 2787, 3013, 1989…
## $ BMI                             &lt;dbl&gt; 19.1, 18.6, 18.1, 17.6, 17.2, 16…
## $ under.five.deaths               &lt;int&gt; 83, 86, 89, 93, 97, 102, 106, 11…
## $ Polio                           &lt;int&gt; 6, 58, 62, 67, 68, 66, 63, 64, 6…
## $ Total.expenditure               &lt;dbl&gt; 8.16, 8.18, 8.13, 8.52, 7.87, 9.…
## $ Diphtheria                      &lt;int&gt; 65, 62, 64, 67, 68, 66, 63, 64, …
## $ HIV.AIDS                        &lt;dbl&gt; 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.…
## $ GDP                             &lt;dbl&gt; 584.25921, 612.69651, 631.74498,…
## $ Population                      &lt;dbl&gt; 33736494, 327582, 31731688, 3696…
## $ thinness..1.19.years            &lt;dbl&gt; 17.2, 17.5, 17.7, 17.9, 18.2, 18…
## $ thinness.5.9.years              &lt;dbl&gt; 17.3, 17.5, 17.7, 18.0, 18.2, 18…
## $ Income.composition.of.resources &lt;dbl&gt; 0.479, 0.476, 0.470, 0.463, 0.45…
## $ Schooling                       &lt;dbl&gt; 10.1, 10.0, 9.9, 9.8, 9.5, 9.2, …</code></pre>
<p>Sumarne podatke po kolonama vidimo ugradjenom funkcijom <code>summary</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(who_data)</code></pre>
<pre><code>##                 Country          Year             Status    
##  Afghanistan        :  16   Min.   :2000   Developed : 512  
##  Albania            :  16   1st Qu.:2004   Developing:2426  
##  Algeria            :  16   Median :2008                    
##  Angola             :  16   Mean   :2008                    
##  Antigua and Barbuda:  16   3rd Qu.:2012                    
##  Argentina          :  16   Max.   :2015                    
##  (Other)            :2842                                   
##  Life.expectancy Adult.Mortality infant.deaths       Alcohol       
##  Min.   :36.30   Min.   :  1.0   Min.   :   0.0   Min.   : 0.0100  
##  1st Qu.:63.10   1st Qu.: 74.0   1st Qu.:   0.0   1st Qu.: 0.8775  
##  Median :72.10   Median :144.0   Median :   3.0   Median : 3.7550  
##  Mean   :69.22   Mean   :164.8   Mean   :  30.3   Mean   : 4.6029  
##  3rd Qu.:75.70   3rd Qu.:228.0   3rd Qu.:  22.0   3rd Qu.: 7.7025  
##  Max.   :89.00   Max.   :723.0   Max.   :1800.0   Max.   :17.8700  
##  NA&#39;s   :10      NA&#39;s   :10                       NA&#39;s   :194      
##  percentage.expenditure  Hepatitis.B       Measles              BMI       
##  Min.   :    0.000      Min.   : 1.00   Min.   :     0.0   Min.   : 1.00  
##  1st Qu.:    4.685      1st Qu.:77.00   1st Qu.:     0.0   1st Qu.:19.30  
##  Median :   64.913      Median :92.00   Median :    17.0   Median :43.50  
##  Mean   :  738.251      Mean   :80.94   Mean   :  2419.6   Mean   :38.32  
##  3rd Qu.:  441.534      3rd Qu.:97.00   3rd Qu.:   360.2   3rd Qu.:56.20  
##  Max.   :19479.912      Max.   :99.00   Max.   :212183.0   Max.   :87.30  
##                         NA&#39;s   :553                        NA&#39;s   :34     
##  under.five.deaths     Polio       Total.expenditure   Diphtheria   
##  Min.   :   0.00   Min.   : 3.00   Min.   : 0.370    Min.   : 2.00  
##  1st Qu.:   0.00   1st Qu.:78.00   1st Qu.: 4.260    1st Qu.:78.00  
##  Median :   4.00   Median :93.00   Median : 5.755    Median :93.00  
##  Mean   :  42.04   Mean   :82.55   Mean   : 5.938    Mean   :82.32  
##  3rd Qu.:  28.00   3rd Qu.:97.00   3rd Qu.: 7.492    3rd Qu.:97.00  
##  Max.   :2500.00   Max.   :99.00   Max.   :17.600    Max.   :99.00  
##                    NA&#39;s   :19      NA&#39;s   :226       NA&#39;s   :19     
##     HIV.AIDS           GDP              Population       
##  Min.   : 0.100   Min.   :     1.68   Min.   :3.400e+01  
##  1st Qu.: 0.100   1st Qu.:   463.94   1st Qu.:1.958e+05  
##  Median : 0.100   Median :  1766.95   Median :1.387e+06  
##  Mean   : 1.742   Mean   :  7483.16   Mean   :1.275e+07  
##  3rd Qu.: 0.800   3rd Qu.:  5910.81   3rd Qu.:7.420e+06  
##  Max.   :50.600   Max.   :119172.74   Max.   :1.294e+09  
##                   NA&#39;s   :448         NA&#39;s   :652        
##  thinness..1.19.years thinness.5.9.years Income.composition.of.resources
##  Min.   : 0.10        Min.   : 0.10      Min.   :0.0000                 
##  1st Qu.: 1.60        1st Qu.: 1.50      1st Qu.:0.4930                 
##  Median : 3.30        Median : 3.30      Median :0.6770                 
##  Mean   : 4.84        Mean   : 4.87      Mean   :0.6276                 
##  3rd Qu.: 7.20        3rd Qu.: 7.20      3rd Qu.:0.7790                 
##  Max.   :27.70        Max.   :28.60      Max.   :0.9480                 
##  NA&#39;s   :34           NA&#39;s   :34         NA&#39;s   :167                    
##    Schooling    
##  Min.   : 0.00  
##  1st Qu.:10.10  
##  Median :12.30  
##  Mean   :11.99  
##  3rd Qu.:14.30  
##  Max.   :20.70  
##  NA&#39;s   :163</code></pre>
</div>
<div id="osnovne-funkcije-paketa-dplyr" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Osnovne funkcije paketa <code>dplyr</code></h3>
<p>Proći ćemo nekoliko primera osnovnih funkcija iz paketa. Najviše ćemo koristiti podatke iz paketa <code>nycflights13</code>, pa ga učitavamo</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nycflights13)</code></pre>
<p>Prelazimo na pregled funkcija.</p>
<div id="select---odabir-kolona" class="section level4">
<h4><span class="header-section-number">3.2.2.1</span> <code>select</code> - odabir kolona</h4>
<p>Sa ovom funkcijom smo se već susreli i nećemo dužiti. Ona služi da iz tabele koja ima mnogo kolona odaberemo samo one koje su nam od interesa, radi lakšeg pregleda.</p>
<p>Odaberimo iz baze <code>flights</code> samo kolone godina, mesec, dan, polazipte i destinacija.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(year, month, day, origin, dest)</code></pre>
<pre><code>## # A tibble: 336,776 x 5
##     year month   day origin dest 
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;
##  1  2013     1     1 EWR    IAH  
##  2  2013     1     1 LGA    IAH  
##  3  2013     1     1 JFK    MIA  
##  4  2013     1     1 JFK    BQN  
##  5  2013     1     1 LGA    ATL  
##  6  2013     1     1 EWR    ORD  
##  7  2013     1     1 EWR    FLL  
##  8  2013     1     1 LGA    IAD  
##  9  2013     1     1 JFK    MCO  
## 10  2013     1     1 LGA    ORD  
## # … with 336,766 more rows</code></pre>
</div>
<div id="filter---filtriranje-redova" class="section level4">
<h4><span class="header-section-number">3.2.2.2</span> <code>filter</code> - Filtriranje redova</h4>
<p>Ova funkcija služi za odabir odgovarajućih vrsta tabele, tj. opservacija, na osnovu željenih kriterijuma.</p>
<p>Kao primer, možemo da izdvojimo iz baze letova one letove koji idu ka Portlandu, sa kodom aerodroma <code>&quot;PDX&quot;</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">portland_flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;PDX&quot;</span>)
<span class="co">#View(portland_flights)</span></code></pre>
<p>Kao argument funkciji <code>filter</code> prosledjuje se uslov koji želimo da ispunjavaju redovi koje biramo. To je zapravo vektor <code>TRUE</code> i <code>FALSE</code> vrednosti, kao kod indeksiranja klasičnog dataframe-a. Ovde smo koristili operator jednakosti <code>==</code>, ali možemo koristiti i druge matematičke operatore poput <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>. Više kriterijuma možemo spajati operatorima konjukcije <code>&amp;</code> (‘i’) i disjunkcije <code>|</code> (‘ili’). Naravno, pored ovih, mogu se koristiti bilo koje funkcije koje daju kao rezultat logičke vektore.</p>
<p>Na primer, možemo da odaberemo letove koji kreću sa aerodroma JFK, a leteli su duže od sat vremena.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(origin <span class="op">==</span><span class="st"> &quot;JFK&quot;</span> <span class="op">&amp;</span><span class="st"> </span>air_time <span class="op">&gt;</span><span class="st"> </span><span class="dv">60</span>)</code></pre>
<pre><code>## # A tibble: 86,058 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
##  1  2013     1     1      542            540         2      923
##  2  2013     1     1      544            545        -1     1004
##  3  2013     1     1      557            600        -3      838
##  4  2013     1     1      558            600        -2      849
##  5  2013     1     1      558            600        -2      853
##  6  2013     1     1      558            600        -2      924
##  7  2013     1     1      606            610        -4      837
##  8  2013     1     1      611            600        11      945
##  9  2013     1     1      613            610         3      925
## 10  2013     1     1      615            615         0     1039
## # … with 86,048 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
## #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
## #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
## #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Odredimo sve letove sa JFK do Berlingtona (BTV) i Sijetla (SEA), koji su od oktobra do kraja godine.</p>
<pre class="sourceCode r"><code class="sourceCode r">btv_sea_flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(origin <span class="op">==</span><span class="st"> &quot;JFK&quot;</span> <span class="op">&amp;</span><span class="st"> </span>(dest <span class="op">==</span><span class="st"> &quot;BTV&quot;</span> <span class="op">|</span><span class="st"> </span>dest <span class="op">==</span><span class="st"> &quot;SEA&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>month <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>)
<span class="co">#View(btv_sea_flights)</span></code></pre>
<p>Umesto korišćenja operatora konjunkcije, možemo samo razdvojiti sve uslove koji moraju biti zadovoljeni sa zapetom.</p>
<pre class="sourceCode r"><code class="sourceCode r">btv_sea_flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(origin <span class="op">==</span><span class="st"> &quot;JFK&quot;</span>, (dest <span class="op">==</span><span class="st"> &quot;BTV&quot;</span> <span class="op">|</span><span class="st"> </span>dest <span class="op">==</span><span class="st"> &quot;SEA&quot;</span>), month <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>)
<span class="co">#View(btv_sea_flights)</span></code></pre>
</div>
<div id="arrange---sortiranje-redova" class="section level4">
<h4><span class="header-section-number">3.2.2.3</span> <code>arrange</code> - sortiranje redova</h4>
<p>Često ima smisla sortirati podatke u odnosu na neku kolonu prilikom istraživanja podataka. Paket <code>dplyr</code> nam daje jednostavan način za to kroz funkciju <code>arrange</code>. Par jednostavnih primera sledi.</p>
<p>Sortirajmo letove po trajanju leta rastuće…</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(air_time) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, air_time)</code></pre>
<pre><code>## # A tibble: 336,776 x 2
##    tailnum air_time
##    &lt;chr&gt;      &lt;dbl&gt;
##  1 N16911        20
##  2 N12167        20
##  3 N27200        21
##  4 N13913        21
##  5 N13955        21
##  6 N12921        21
##  7 N947UW        21
##  8 N8501F        21
##  9 N12160        21
## 10 N16987        21
## # … with 336,766 more rows</code></pre>
<p>… ili opadajuće</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(air_time)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, air_time)</code></pre>
<pre><code>## # A tibble: 336,776 x 2
##    tailnum air_time
##    &lt;chr&gt;      &lt;dbl&gt;
##  1 N77066       695
##  2 N389HA       691
##  3 N388HA       686
##  4 N380HA       686
##  5 N384HA       683
##  6 N386HA       679
##  7 N59053       676
##  8 N380HA       676
##  9 N386HA       675
## 10 N76065       671
## # … with 336,766 more rows</code></pre>
<p>Vrlo korisna opcija je što se sortiranje može vršiti po više promenljivih. Na primer, da bismo sortirali letove po datumu leta, počevši od najskorijeg, treba da sortiramo prvo opadajuće po mesecu, ali i one iz istog meseca treba sortirati opadajuće po danu. Ovo radimo na sledeći način</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># radi lakseg pregleda, uzecemo podskup od</span>
<span class="co"># 10 letova</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
subflights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>) 
subflights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(month), <span class="kw">desc</span>(day)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, month, day)</code></pre>
<pre><code>## # A tibble: 10 x 3
##    tailnum month   day
##    &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
##  1 N14731     12     7
##  2 N555AA     11    14
##  3 N722MQ      9    10
##  4 N537JB      8    28
##  5 N844VA      8    24
##  6 N16559      6     1
##  7 N509JB      5    20
##  8 N3AEAA      4    30
##  9 N14573      2    17
## 10 N3767       1    24</code></pre>
<p><strong>Napomena!</strong> Obratite pažnju, bitan je redosled argumenata u <code>arrange</code>, ako sortiramo prvo po danu pa po mesecu, ne dobijamo željeni rezultat.</p>
<pre class="sourceCode r"><code class="sourceCode r">subflights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(day), <span class="kw">desc</span>(month)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, month, day)</code></pre>
<pre><code>## # A tibble: 10 x 3
##    tailnum month   day
##    &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
##  1 N3AEAA      4    30
##  2 N537JB      8    28
##  3 N844VA      8    24
##  4 N3767       1    24
##  5 N509JB      5    20
##  6 N14573      2    17
##  7 N555AA     11    14
##  8 N722MQ      9    10
##  9 N14731     12     7
## 10 N16559      6     1</code></pre>
<p>Sortirajmo letove opadajuće po datumu, ali rastuće po trajanju leta</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(month), <span class="kw">desc</span>(day), air_time) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, month, day, air_time)</code></pre>
<pre><code>## # A tibble: 336,776 x 4
##    tailnum month   day air_time
##    &lt;chr&gt;   &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
##  1 N952UW     12    31       28
##  2 N13975     12    31       29
##  3 N197JB     12    31       32
##  4 N304JB     12    31       32
##  5 N76514     12    31       32
##  6 N236JB     12    31       32
##  7 N329JB     12    31       33
##  8 N351JB     12    31       33
##  9 N3JAAA     12    31       33
## 10 N206JB     12    31       33
## # … with 336,766 more rows</code></pre>
</div>
<div id="mutate---dodavanje-nove-kolone" class="section level4">
<h4><span class="header-section-number">3.2.2.4</span> <code>mutate</code> - dodavanje nove kolone</h4>
<p>Ovom funkcijom možemo da napravimo nove kolone koristeći postojeće. Na primer, možemo da vršimo konverziju iz Farenhajta u Celzijus.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ovako smo ranije</span>
<span class="co"># weather$celsius &lt;- (weather$temp - 32) * 5 / 9</span>

<span class="co"># dplyr nacin:</span>
weather &lt;-<span class="st"> </span>weather <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">celsius =</span> (temp <span class="op">-</span><span class="st"> </span><span class="dv">32</span>) <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">9</span>)

<span class="co">#View(weather)</span></code></pre>
<p>Možemo praviti više novih kolona odjednom. Na primer, dodaćemo kolonu “gain” koja predstavlja razliku izmedju kašnjenja polaska i kašnjenja dolaska, tj. neki vid nadoknadjenog vremena kada je let kasnio sa polaskom. Pored toga, dodaćemo kolonu koja predstavlja let u satima, i odrediti i “gain” po satu.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">gain =</span> dep_delay <span class="op">-</span><span class="st"> </span>arr_delay,
    <span class="dt">hours =</span> air_time <span class="op">/</span><span class="st"> </span><span class="dv">60</span>,
    <span class="dt">gain_per_hour =</span> gain <span class="op">/</span><span class="st"> </span>hours
  )</code></pre>
<p>I sortiramo po <code>gain_per_hour</code></p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(gain_per_hour) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(dep_delay, arr_delay, gain, hours, air_time, gain_per_hour)</code></pre>
<pre><code>## # A tibble: 336,776 x 6
##    dep_delay arr_delay  gain hours air_time gain_per_hour
##        &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;
##  1       171       273  -102 0.517       31         -197.
##  2        62       177  -115 0.6         36         -192.
##  3        11       122  -111 0.6         36         -185 
##  4       115       233  -118 0.667       40         -177 
##  5        -7       106  -113 0.65        39         -174.
##  6        -8       123  -131 0.767       46         -171.
##  7        -1       109  -110 0.65        39         -169.
##  8        39       152  -113 0.7         42         -161.
##  9         3        94   -91 0.567       34         -161.
## 10        33       136  -103 0.65        39         -158.
## # … with 336,766 more rows</code></pre>
<p>Ako uposlimo i paket <code>lubridate</code>, koji značajno olakšava rad sa datumima u R-u, možemo dodati i kolonu koja sadrži tačno vreme leta, umesto komponenti koje imamo sada.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;lubridate&quot;)</span>
<span class="kw">library</span>(lubridate)

flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">departure =</span> <span class="kw">make_datetime</span>(year, month, day, hour, minute))

flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(year, month, day, hour, minute, departure)</code></pre>
<pre><code>## # A tibble: 336,776 x 6
##     year month   day  hour minute departure          
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dttm&gt;             
##  1  2013     1     1     5     15 2013-01-01 05:15:00
##  2  2013     1     1     5     29 2013-01-01 05:29:00
##  3  2013     1     1     5     40 2013-01-01 05:40:00
##  4  2013     1     1     5     45 2013-01-01 05:45:00
##  5  2013     1     1     6      0 2013-01-01 06:00:00
##  6  2013     1     1     5     58 2013-01-01 05:58:00
##  7  2013     1     1     6      0 2013-01-01 06:00:00
##  8  2013     1     1     6      0 2013-01-01 06:00:00
##  9  2013     1     1     6      0 2013-01-01 06:00:00
## 10  2013     1     1     6      0 2013-01-01 06:00:00
## # … with 336,766 more rows</code></pre>
<p>Sada prethodno sortiranje opadajuće možemo odratiti po toj novoj koloni.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(departure)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, month, day, departure)</code></pre>
<pre><code>## # A tibble: 10 x 4
##    tailnum month   day departure          
##    &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dttm&gt;             
##  1 N14731     12     7 2013-12-07 14:45:00
##  2 N555AA     11    14 2013-11-14 06:00:00
##  3 N722MQ      9    10 2013-09-10 19:50:00
##  4 N537JB      8    28 2013-08-28 09:01:00
##  5 N844VA      8    24 2013-08-24 16:55:00
##  6 N16559      6     1 2013-06-01 12:32:00
##  7 N509JB      5    20 2013-05-20 19:05:00
##  8 N3AEAA      4    30 2013-04-30 13:45:00
##  9 N14573      2    17 2013-02-17 08:15:00
## 10 N3767       1    24 2013-01-24 18:50:00</code></pre>
<p>Specijalan slučaj <code>mutate</code> naredbe je <code>rename</code> koju koristimo za preimenovanje kolona.</p>
<pre class="sourceCode r"><code class="sourceCode r">weather <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">temp_C =</span> celsius)</code></pre>
<pre><code>## # A tibble: 26,115 x 16
##    origin  year month   day  hour  temp  dewp humid wind_dir wind_speed
##    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4 
##  2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06
##  3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5 
##  4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7 
##  5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7 
##  6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5 
##  7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0 
##  8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4 
##  9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0 
## 10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8 
## # … with 26,105 more rows, and 6 more variables: wind_gust &lt;dbl&gt;,
## #   precip &lt;dbl&gt;, pressure &lt;dbl&gt;, visib &lt;dbl&gt;, time_hour &lt;dttm&gt;,
## #   temp_C &lt;dbl&gt;</code></pre>
</div>
<div id="summarise---sumarne-statistike" class="section level4">
<h4><span class="header-section-number">3.2.2.5</span> <code>summarise</code> - sumarne statistike</h4>
<p>Ova, jedna od korisnijih funkcija, služi za računanje neke statistike nad podacima. Podaci mogu biti i grupisani, što ćemo videti kasnije. Za početak, vidimo neki prosti primer.</p>
<p>Prosečno vreme trajanja letova dobijamo ovako:</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="kw">mean</span>(air_time))</code></pre>
<pre><code>## # A tibble: 1 x 1
##   `mean(air_time)`
##              &lt;dbl&gt;
## 1               NA</code></pre>
<p>Ima NA vrednosti, pa dodajemo <code>na.rm = TRUE</code>, da bi ih ignorisali prilikom računa.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="kw">mean</span>(air_time, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre>
<pre><code>## # A tibble: 1 x 1
##   `mean(air_time, na.rm = TRUE)`
##                            &lt;dbl&gt;
## 1                           151.</code></pre>
<p>Da vidimo i ukupan broj letova, koristimo specijalnu funkciju <code>n()</code>. Dodajmo i kvantile iz poziva <code>summary</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">no_na_flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(air_time))

no_na_flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">count =</span> <span class="kw">n</span>(),
    <span class="dt">min_time =</span> <span class="kw">min</span>(air_time),
    <span class="dt">time_q1 =</span> <span class="kw">quantile</span>(air_time, <span class="fl">0.25</span>),
    <span class="dt">median_time =</span> <span class="kw">median</span>(air_time),
    <span class="dt">mean_time =</span> <span class="kw">mean</span>(air_time),
    <span class="dt">time_13 =</span> <span class="kw">quantile</span>(air_time, <span class="fl">0.75</span>),
    <span class="dt">max_time =</span> <span class="kw">max</span>(air_time)
  )</code></pre>
<pre><code>## # A tibble: 1 x 7
##    count min_time time_q1 median_time mean_time time_13 max_time
##    &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1 327346       20      82         129      151.     192      695</code></pre>
<p>Vidimo poklapanje sa <code>summary</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(no_na_flights<span class="op">$</span>air_time)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    20.0    82.0   129.0   150.7   192.0   695.0</code></pre>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="1153-highcharter.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
