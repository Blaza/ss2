<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Rad sa podacima | Statistički softver 2</title>
  <meta name="description" content="3 Rad sa podacima | Statistički softver 2" />
  <meta name="generator" content="bookdown 0.10.2 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Rad sa podacima | Statistički softver 2" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Rad sa podacima | Statistički softver 2" />
  
  
  

<meta name="author" content="Blagoje Ivanović" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="1153-highcharter.html">
<link rel="next" href="21-mle.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.46.1/plotly-latest.min.js"></script>
<script src="libs/proj4js-2.3.15/proj4.js"></script>
<link href="libs/highcharts-7.0.1/css/motion.css" rel="stylesheet" />
<link href="libs/highcharts-7.0.1/css/htmlwdgtgrid.css" rel="stylesheet" />
<script src="libs/highcharts-7.0.1/highcharts.js"></script>
<script src="libs/highcharts-7.0.1/highcharts-3d.js"></script>
<script src="libs/highcharts-7.0.1/highcharts-more.js"></script>
<script src="libs/highcharts-7.0.1/modules/stock.js"></script>
<script src="libs/highcharts-7.0.1/modules/map.js"></script>
<script src="libs/highcharts-7.0.1/modules/annotations.js"></script>
<script src="libs/highcharts-7.0.1/modules/boost.js"></script>
<script src="libs/highcharts-7.0.1/modules/data.js"></script>
<script src="libs/highcharts-7.0.1/modules/drag-panes.js"></script>
<script src="libs/highcharts-7.0.1/modules/drilldown.js"></script>
<script src="libs/highcharts-7.0.1/modules/item-series.js"></script>
<script src="libs/highcharts-7.0.1/modules/offline-exporting.js"></script>
<script src="libs/highcharts-7.0.1/modules/overlapping-datalabels.js"></script>
<script src="libs/highcharts-7.0.1/modules/exporting.js"></script>
<script src="libs/highcharts-7.0.1/modules/export-data.js"></script>
<script src="libs/highcharts-7.0.1/modules/funnel.js"></script>
<script src="libs/highcharts-7.0.1/modules/heatmap.js"></script>
<script src="libs/highcharts-7.0.1/modules/treemap.js"></script>
<script src="libs/highcharts-7.0.1/modules/sankey.js"></script>
<script src="libs/highcharts-7.0.1/modules/solid-gauge.js"></script>
<script src="libs/highcharts-7.0.1/modules/streamgraph.js"></script>
<script src="libs/highcharts-7.0.1/modules/sunburst.js"></script>
<script src="libs/highcharts-7.0.1/modules/vector.js"></script>
<script src="libs/highcharts-7.0.1/modules/wordcloud.js"></script>
<script src="libs/highcharts-7.0.1/modules/xrange.js"></script>
<script src="libs/highcharts-7.0.1/modules/tilemap.js"></script>
<script src="libs/highcharts-7.0.1/modules/venn.js"></script>
<script src="libs/highcharts-7.0.1/modules/gantt.js"></script>
<script src="libs/highcharts-7.0.1/modules/timeline.js"></script>
<script src="libs/highcharts-7.0.1/modules/parallel-coordinates.js"></script>
<script src="libs/highcharts-7.0.1/plugins/grouped-categories.js"></script>
<script src="libs/highcharts-7.0.1/plugins/motion.js"></script>
<script src="libs/highcharts-7.0.1/plugins/multicolor_series.js"></script>
<script src="libs/highcharts-7.0.1/custom/reset.js"></script>
<script src="libs/highcharts-7.0.1/custom/symbols-extra.js"></script>
<script src="libs/highcharts-7.0.1/custom/text-symbols.js"></script>
<script src="libs/highchart-binding-0.7.0/highchart.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Predgovor</a></li>
<li class="chapter" data-level="1" data-path="11-ggplot.html"><a href="11-ggplot.html"><i class="fa fa-check"></i><b>1</b> Grafički prikaz podataka</a><ul>
<li class="chapter" data-level="1.1" data-path="11-ggplot.html"><a href="11-ggplot.html#uvodni-primeri-i-napomene"><i class="fa fa-check"></i><b>1.1</b> Uvodni primeri i napomene</a></li>
<li class="chapter" data-level="1.2" data-path="11-ggplot.html"><a href="11-ggplot.html#razni-primeri-grafika"><i class="fa fa-check"></i><b>1.2</b> Razni primeri grafika</a><ul>
<li class="chapter" data-level="1.2.1" data-path="11-ggplot.html"><a href="11-ggplot.html#scatterplotovi"><i class="fa fa-check"></i><b>1.2.1</b> Scatterplotovi</a></li>
<li class="chapter" data-level="1.2.2" data-path="11-ggplot.html"><a href="11-ggplot.html#linijski-grafici"><i class="fa fa-check"></i><b>1.2.2</b> Linijski grafici</a></li>
<li class="chapter" data-level="1.2.3" data-path="11-ggplot.html"><a href="11-ggplot.html#histogrami"><i class="fa fa-check"></i><b>1.2.3</b> Histogrami</a></li>
<li class="chapter" data-level="1.2.4" data-path="11-ggplot.html"><a href="11-ggplot.html#crtanje-vise-grafika-odjednom"><i class="fa fa-check"></i><b>1.2.4</b> Crtanje više grafika odjednom</a></li>
<li class="chapter" data-level="1.2.5" data-path="11-ggplot.html"><a href="11-ggplot.html#boks-plotovi"><i class="fa fa-check"></i><b>1.2.5</b> Boks plotovi</a></li>
<li class="chapter" data-level="1.2.6" data-path="11-ggplot.html"><a href="11-ggplot.html#bar-plotovi"><i class="fa fa-check"></i><b>1.2.6</b> Bar plotovi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="115-galerija.html"><a href="115-galerija.html"><i class="fa fa-check"></i><b>2</b> Galerija grafika</a><ul>
<li class="chapter" data-level="" data-path="115-galerija.html"><a href="115-galerija.html#uvod"><i class="fa fa-check"></i>Uvod</a></li>
<li class="chapter" data-level="2.1" data-path="115-galerija.html"><a href="115-galerija.html#ggplot2"><i class="fa fa-check"></i><b>2.1</b> Ggplot2</a><ul>
<li class="chapter" data-level="2.1.1" data-path="115-galerija.html"><a href="115-galerija.html#linijski-grafici-1"><i class="fa fa-check"></i><b>2.1.1</b> Linijski grafici</a></li>
<li class="chapter" data-level="2.1.2" data-path="115-galerija.html"><a href="115-galerija.html#stacked-area-chart"><i class="fa fa-check"></i><b>2.1.2</b> Stacked area chart</a></li>
<li class="chapter" data-level="2.1.3" data-path="115-galerija.html"><a href="115-galerija.html#sezonski-grafik"><i class="fa fa-check"></i><b>2.1.3</b> Sezonski grafik</a></li>
<li class="chapter" data-level="2.1.4" data-path="115-galerija.html"><a href="115-galerija.html#bar-plotovi-1"><i class="fa fa-check"></i><b>2.1.4</b> Bar plotovi</a></li>
<li class="chapter" data-level="2.1.5" data-path="115-galerija.html"><a href="115-galerija.html#lollipop-grafik"><i class="fa fa-check"></i><b>2.1.5</b> Lollipop grafik</a></li>
<li class="chapter" data-level="2.1.6" data-path="115-galerija.html"><a href="115-galerija.html#dumbbell-plot"><i class="fa fa-check"></i><b>2.1.6</b> Dumbbell plot</a></li>
<li class="chapter" data-level="2.1.7" data-path="115-galerija.html"><a href="115-galerija.html#histogram"><i class="fa fa-check"></i><b>2.1.7</b> Histogram</a></li>
<li class="chapter" data-level="2.1.8" data-path="115-galerija.html"><a href="115-galerija.html#grafik-gustine"><i class="fa fa-check"></i><b>2.1.8</b> Grafik gustine</a></li>
<li class="chapter" data-level="2.1.9" data-path="115-galerija.html"><a href="115-galerija.html#boks-plot"><i class="fa fa-check"></i><b>2.1.9</b> Boks plot</a></li>
<li class="chapter" data-level="2.1.10" data-path="115-galerija.html"><a href="115-galerija.html#violinski-grafik"><i class="fa fa-check"></i><b>2.1.10</b> Violinski grafik</a></li>
<li class="chapter" data-level="2.1.11" data-path="115-galerija.html"><a href="115-galerija.html#populaciona-piramida"><i class="fa fa-check"></i><b>2.1.11</b> Populaciona piramida</a></li>
<li class="chapter" data-level="2.1.12" data-path="115-galerija.html"><a href="115-galerija.html#pitica"><i class="fa fa-check"></i><b>2.1.12</b> Pitica</a></li>
<li class="chapter" data-level="2.1.13" data-path="115-galerija.html"><a href="115-galerija.html#hijerarhijski-dendrogram"><i class="fa fa-check"></i><b>2.1.13</b> Hijerarhijski dendrogram</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="1152-plotly.html"><a href="1152-plotly.html"><i class="fa fa-check"></i><b>2.2</b> Plotly</a><ul>
<li class="chapter" data-level="2.2.1" data-path="1152-plotly.html"><a href="1152-plotly.html#scatterplot"><i class="fa fa-check"></i><b>2.2.1</b> Scatterplot</a></li>
<li class="chapter" data-level="2.2.2" data-path="1152-plotly.html"><a href="1152-plotly.html#histogram-i-bar-plot"><i class="fa fa-check"></i><b>2.2.2</b> Histogram i Bar plot</a></li>
<li class="chapter" data-level="2.2.3" data-path="1152-plotly.html"><a href="1152-plotly.html#box-plot"><i class="fa fa-check"></i><b>2.2.3</b> Box plot</a></li>
<li class="chapter" data-level="2.2.4" data-path="1152-plotly.html"><a href="1152-plotly.html#pravougaono-naslaganje"><i class="fa fa-check"></i><b>2.2.4</b> Pravougaono naslaganje</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="1153-highcharter.html"><a href="1153-highcharter.html"><i class="fa fa-check"></i><b>2.3</b> Highcharter</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="12-dplyr.html"><a href="12-dplyr.html"><i class="fa fa-check"></i><b>3</b> Rad sa podacima</a><ul>
<li class="chapter" data-level="3.1" data-path="12-dplyr.html"><a href="12-dplyr.html#dataframe"><i class="fa fa-check"></i><b>3.1</b> Dataframe</a></li>
<li class="chapter" data-level="3.2" data-path="12-dplyr.html"><a href="12-dplyr.html#obrada-podataka---dplyr-paket"><i class="fa fa-check"></i><b>3.2</b> Obrada podataka - <code>dplyr</code> paket</a></li>
<li class="chapter" data-level="3.3" data-path="12-dplyr.html"><a href="12-dplyr.html#ucitavanje-eksternih-podataka"><i class="fa fa-check"></i><b>3.3</b> Učitavanje eksternih podataka</a></li>
<li class="chapter" data-level="3.4" data-path="12-dplyr.html"><a href="12-dplyr.html#osnovne-funkcije-paketa-dplyr"><i class="fa fa-check"></i><b>3.4</b> Osnovne funkcije paketa <code>dplyr</code></a><ul>
<li class="chapter" data-level="3.4.1" data-path="12-dplyr.html"><a href="12-dplyr.html#select---odabir-kolona"><i class="fa fa-check"></i><b>3.4.1</b> <code>select</code> - odabir kolona</a></li>
<li class="chapter" data-level="3.4.2" data-path="12-dplyr.html"><a href="12-dplyr.html#filter---filtriranje-redova"><i class="fa fa-check"></i><b>3.4.2</b> <code>filter</code> - Filtriranje redova</a></li>
<li class="chapter" data-level="3.4.3" data-path="12-dplyr.html"><a href="12-dplyr.html#arrange---sortiranje-redova"><i class="fa fa-check"></i><b>3.4.3</b> <code>arrange</code> - sortiranje redova</a></li>
<li class="chapter" data-level="3.4.4" data-path="12-dplyr.html"><a href="12-dplyr.html#mutate---dodavanje-nove-kolone"><i class="fa fa-check"></i><b>3.4.4</b> <code>mutate</code> - dodavanje nove kolone</a></li>
<li class="chapter" data-level="3.4.5" data-path="12-dplyr.html"><a href="12-dplyr.html#summarise---sumarne-statistike"><i class="fa fa-check"></i><b>3.4.5</b> <code>summarise</code> - sumarne statistike</a></li>
<li class="chapter" data-level="3.4.6" data-path="12-dplyr.html"><a href="12-dplyr.html#group_by---grupisanje-opservacija"><i class="fa fa-check"></i><b>3.4.6</b> <code>group_by</code> - grupisanje opservacija</a></li>
<li class="chapter" data-level="3.4.7" data-path="12-dplyr.html"><a href="12-dplyr.html#join---spajanje-tabela"><i class="fa fa-check"></i><b>3.4.7</b> <code>join</code> - spajanje tabela</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="21-mle.html"><a href="21-mle.html"><i class="fa fa-check"></i><b>4</b> Ocenjivanje metodom maksimalne verodostojnosti</a><ul>
<li class="chapter" data-level="4.1" data-path="21-mle.html"><a href="21-mle.html#njutnova-metoda"><i class="fa fa-check"></i><b>4.1</b> Njutnova metoda</a><ul>
<li class="chapter" data-level="4.1.1" data-path="21-mle.html"><a href="21-mle.html#primer-kosijeve-raspodele"><i class="fa fa-check"></i><b>4.1.1</b> Primer Košijeve raspodele</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="211-em.html"><a href="211-em.html"><i class="fa fa-check"></i><b>4.2</b> EM algoritam</a><ul>
<li class="chapter" data-level="4.2.1" data-path="211-em.html"><a href="211-em.html#ocena-parametra-sa-histograma"><i class="fa fa-check"></i><b>4.2.1</b> Ocena parametra sa histograma</a></li>
<li class="chapter" data-level="4.2.2" data-path="211-em.html"><a href="211-em.html#ocenjivanje-mesavine-normalnih-raspodela"><i class="fa fa-check"></i><b>4.2.2</b> Ocenjivanje mešavine normalnih raspodela</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="31-lm.html"><a href="31-lm.html"><i class="fa fa-check"></i><b>5</b> Osnove linearnih modela</a><ul>
<li class="chapter" data-level="5.1" data-path="31-lm.html"><a href="31-lm.html#regresija"><i class="fa fa-check"></i><b>5.1</b> Regresija</a></li>
<li class="chapter" data-level="5.2" data-path="31-lm.html"><a href="31-lm.html#linearna-regresija"><i class="fa fa-check"></i><b>5.2</b> Linearna regresija</a><ul>
<li class="chapter" data-level="5.2.1" data-path="31-lm.html"><a href="31-lm.html#sta-znaci-najbolje"><i class="fa fa-check"></i><b>5.2.1</b> Šta znači najbolje?</a></li>
<li class="chapter" data-level="5.2.2" data-path="31-lm.html"><a href="31-lm.html#nalazenje-optimalne-prave"><i class="fa fa-check"></i><b>5.2.2</b> Nalaženje optimalne prave</a></li>
<li class="chapter" data-level="5.2.3" data-path="31-lm.html"><a href="31-lm.html#visestruka-linearna-regresija"><i class="fa fa-check"></i><b>5.2.3</b> Višestruka linearna regresija</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="31-lm.html"><a href="31-lm.html#linearni-modeli-u-r-u"><i class="fa fa-check"></i><b>5.3</b> Linearni modeli u R-u</a><ul>
<li class="chapter" data-level="" data-path="31-lm.html"><a href="31-lm.html#testiranje-znacajnosti-koeficijenata"><i class="fa fa-check"></i>Testiranje značajnosti koeficijenata</a></li>
<li class="chapter" data-level="5.3.1" data-path="31-lm.html"><a href="31-lm.html#koeficijent-determinacije"><i class="fa fa-check"></i><b>5.3.1</b> Koeficijent determinacije</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistički softver 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rad-sa-podacima" class="section level1">
<h1><span class="header-section-number">3</span> Rad sa podacima</h1>
<p>U ovom poglavlju ćemo se upoznati sa osnovnim metodama rada sa podacima, prvenstveno kroz paket <code>dplyr</code>, koji je jedan od najkorišćenijih paketa u R-u. Pre upoznavanja sa tim paketom, osnvrnućemo se na osnovnu strukturu podataka u R-u, dataframe, koja se koristi za rad sa tabelarnim podacima.</p>
<div id="dataframe" class="section level2">
<h2><span class="header-section-number">3.1</span> Dataframe</h2>
<p>Dataframe je najčešći način čuvanja podataka u R-u i vrlo je pogodan za rad i analizu. Služi za prikaz tabelarnih podataka, pa liči na matricu, s tim što je dataframe u snovi lista koja sadrži vektore jednakih dužina (kolone), pri čemu ti vektori ne moraju biti istog tipa. Dakle možemo imati jednu kolonu koju čine brojevi, a drugu tekstualni podaci.</p>
<p>Dataframe se pravi na sledeći način:</p>
<pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">kolona2 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi&quot;</span>, <span class="st">&quot;drugi&quot;</span>, <span class="st">&quot;treci&quot;</span>))
df</code></pre>
<pre><code>##   kolona1 kolona2
## 1       1    prvi
## 2       2   drugi
## 3       3   treci</code></pre>
<p>Ovako smo dobili dataframe sa dve kolone, od kojih je jedna numerička a druga tekstualna.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(df)</code></pre>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  2 variables:
##  $ kolona1: num  1 2 3
##  $ kolona2: Factor w/ 3 levels &quot;drugi&quot;,&quot;prvi&quot;,..: 2 1 3</code></pre>
<p>R podrazumevano pretvara tekstualne podatke u faktore, to možemo preduprediti ako dodamo argument <code>stringsAsFactors = FALSE</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">kolona2 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi&quot;</span>, <span class="st">&quot;drugi&quot;</span>, <span class="st">&quot;treci&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">str</span>(df)</code></pre>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  2 variables:
##  $ kolona1: num  1 2 3
##  $ kolona2: chr  &quot;prvi&quot; &quot;drugi&quot; &quot;treci&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df</code></pre>
<pre><code>##   kolona1 kolona2
## 1       1    prvi
## 2       2   drugi
## 3       3   treci</code></pre>
<p>Dva dataframe-a (koji imaju isi broj kolona) se mogu spojiti da dobijemo više kolona korišćenjem funkcije <code>cbind</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">kolona2 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi&quot;</span>, <span class="st">&quot;drugi&quot;</span>, <span class="st">&quot;treci&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona3 =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="dt">kolona4 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi1&quot;</span>, <span class="st">&quot;drugi1&quot;</span>, <span class="st">&quot;treci1&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
df3 &lt;-<span class="st"> </span><span class="kw">cbind</span>(df1, df2)
df3</code></pre>
<pre><code>##   kolona1 kolona2 kolona3 kolona4
## 1       1    prvi       4   prvi1
## 2       2   drugi       5  drugi1
## 3       3   treci       6  treci1</code></pre>
<p>Takodje, mogu se nadovezati po vrstama (ako imaju ista imena kolona) funkcijom <code>rbind</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona1 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">kolona2 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi&quot;</span>, <span class="st">&quot;drugi&quot;</span>, <span class="st">&quot;treci&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">kolona1 =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="dt">kolona2 =</span> <span class="kw">c</span>(<span class="st">&quot;prvi1&quot;</span>, <span class="st">&quot;drugi1&quot;</span>, <span class="st">&quot;treci1&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
df4 &lt;-<span class="st"> </span><span class="kw">rbind</span>(df1, df2)
df4</code></pre>
<pre><code>##   kolona1 kolona2
## 1       1    prvi
## 2       2   drugi
## 3       3   treci
## 4       4   prvi1
## 5       5  drugi1
## 6       6  treci1</code></pre>
<p>Vrednostima kolona možemo pristupati pomoću operatora <code>$</code>, kao u listama, a istim možemo i dodati nove kolone.</p>
<pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>kolona1</code></pre>
<pre><code>## [1] 1 2 3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>kolona5 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)
df</code></pre>
<pre><code>##   kolona1 kolona2 kolona5
## 1       1    prvi       7
## 2       2   drugi       8
## 3       3   treci       9</code></pre>
<p>Medjutim, možda elegantniji način filtriranja i odabira podskupova dataframe-a je korišćenjem uglatih zagrada. Koristimo notaciju <code>df[redovi, kolone]</code>, gde prvim argumentom odredjujemo koje redove želimo da uzmemo, a drugim koje kolone. Prazno mesto za neki od argumenata znači “uzmi sve”.</p>
<pre class="sourceCode r"><code class="sourceCode r">df[,] <span class="co"># sve</span></code></pre>
<pre><code>##   kolona1 kolona2 kolona5
## 1       1    prvi       7
## 2       2   drugi       8
## 3       3   treci       9</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df[<span class="dv">1</span>,] <span class="co"># prva vrsta</span></code></pre>
<pre><code>##   kolona1 kolona2 kolona5
## 1       1    prvi       7</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df[,<span class="dv">1</span>] <span class="co"># prva kolona</span></code></pre>
<pre><code>## [1] 1 2 3</code></pre>
<p>Redovi mogu biti ili vektori brojeva koji označavaju indekse redova koje da uzmemo, ili vektori TRUE/FALSE vrednosti iste dužine kao broj vrsta u dataframe-u, pri čemu se tada biraju redovi na pozicijama gde je u vektoru vrednost TRUE.</p>
<pre class="sourceCode r"><code class="sourceCode r">df4[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>), ] <span class="co"># sve kolone, redovi 1,3,4</span></code></pre>
<pre><code>##   kolona1 kolona2
## 1       1    prvi
## 3       3   treci
## 4       4   prvi1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df4[df4<span class="op">$</span>kolona1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>, ] <span class="co"># sve kolone, one vrste kod kojih je kolona1 veca od 3</span></code></pre>
<pre><code>##   kolona1 kolona2
## 4       4   prvi1
## 5       5  drugi1
## 6       6  treci1</code></pre>
<p>Kolone mogu biti ili vektori brojeva koji označavaju koje kolone da uzmemo prema indeksu, ili vektori stringova, koji označavaju imena kolona koje da uzmemo.</p>
<pre class="sourceCode r"><code class="sourceCode r">df3[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)] <span class="co"># sve vrste, 1 i 3 kolona</span></code></pre>
<pre><code>##   kolona1 kolona3
## 1       1       4
## 2       2       5
## 3       3       6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df3[, <span class="kw">c</span>(<span class="st">&quot;kolona1&quot;</span>, <span class="st">&quot;kolona3&quot;</span>)] <span class="co"># isto</span></code></pre>
<pre><code>##   kolona1 kolona3
## 1       1       4
## 2       2       5
## 3       3       6</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df3[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="st">&quot;kolona1&quot;</span>, <span class="st">&quot;kolona3&quot;</span>)] <span class="co"># prvi i treci red, prva i treca kolona</span></code></pre>
<pre><code>##   kolona1 kolona3
## 1       1       4
## 3       3       6</code></pre>
<p>Korisna stvar je da ako koristimo vektore brojeva za indeksiranje, ukoliko stavimo znak <code>-</code> ispred, to znači da izuzimamo te redove/kolone.</p>
<pre class="sourceCode r"><code class="sourceCode r">df[, <span class="dv">-1</span>] <span class="co"># sve bez prve kolone</span></code></pre>
<pre><code>##   kolona2 kolona5
## 1    prvi       7
## 2   drugi       8
## 3   treci       9</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df[<span class="op">-</span><span class="dv">2</span>, ] <span class="co"># sve bez druge vrste</span></code></pre>
<pre><code>##   kolona1 kolona2 kolona5
## 1       1    prvi       7
## 3       3   treci       9</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">df[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="st">&quot;kolona2&quot;</span>, <span class="st">&quot;kolona5&quot;</span>)] <span class="co"># druga i peta kolona, bez prve i druge vrste</span></code></pre>
<pre><code>##   kolona2 kolona5
## 3   treci       9</code></pre>
<p>Konačno, za osnovne informacije o tabeli postoje funkcije <code>colnames</code>, <code>rownames</code>, <code>ncol</code> i <code>nrow</code>, za koje možete pretpostaviti šta rade.</p>
</div>
<div id="obrada-podataka---dplyr-paket" class="section level2">
<h2><span class="header-section-number">3.2</span> Obrada podataka - <code>dplyr</code> paket</h2>
<p>Prethodno navedeni način rada sa tabelarnim podacima učitanim kao dataframe može postati prilično nezgrapan kod komplikovanijih zahteva, pa je stoga smišljen mnogo elegantniji pristup pomoću paketa <code>dplyr</code>. Uvodni tutorijal za paket možete naći i na <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html" class="uri">https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html</a>.</p>
<p>Zansnovan je na korišćenju nekoliko osnovnih radnji koje se primenjuju na podacima, koje su implementirane funkcijama:</p>
<ul>
<li><code>select</code> - biranje kolona iz tabele</li>
<li><code>filter</code> - filtriranje vrsta tabele</li>
<li><code>arrange</code> - sortiranje vrsta na osnovu nekih kolona</li>
<li><code>mutate</code> - pravljenje novih kolona korišćenjem postojećih</li>
<li><code>summarise</code> - računanje neke sumarne statistike (grupisanih) podataka</li>
</ul>
<p>Postoji i mnogo više funkcija u ovom paketu, koje su često slične navedenim i koje ćemo kad za to bude potrebe pokazati.</p>
<p>Uz ovaj paket se upotrebljava malo čunija sintaksa, zasnovana na korišćenju operatora kompozicije <code>%&gt;%</code>. Najlakše ćemo pokazati primerom šta on radi.</p>
<p>Uzmimo pomoću paketa <code>dplyr</code> kolonu 1 iz našeg dataframe-a.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(kolona1)</code></pre>
<pre><code>##   kolona1
## 1       1
## 2       2
## 3       3</code></pre>
<p>Ovo je ekvivalentno pozivu</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(df, kolona1)</code></pre>
<pre><code>##   kolona1
## 1       1
## 2       2
## 3       3</code></pre>
<p>Operator <code>%&gt;%</code> radi tako što prosledjuje levi operand kao prvi argument funkcije date sa desne strane operatora, pa ostale argumente prosledjuje kao dodatne. Suštinski, kod <code>x %&gt;% f(y)</code> postaje <code>f(x, y)</code>. Ako želimo da specifikujemo gde hoćemo da stavimo levu stranu operatora, koristimo <code>.</code>. Na primer, gornji kod je ekvivalentan</p>
<pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(., kolona1)</code></pre>
<pre><code>##   kolona1
## 1       1
## 2       2
## 3       3</code></pre>
<p>Vremenom će postati ovakva sintaksa prirodna. Vrlo je elegantna jer omogućava jednostavno nadovezivanje. Na sledeći način iz <code>df</code> izaberemo prve dve kolone i filtriramo da uzmemo vrste gde je prva kolona veća od 1.</p>
<pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(kolona1, kolona2) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(kolona1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</code></pre>
<pre><code>##   kolona1 kolona2
## 1       2   drugi
## 2       3   treci</code></pre>
<p>Ovime smo videli već primere korišćenja dve funkcije u <code>dplyr</code> paketu - <code>select</code> i <code>filter</code>.</p>
</div>
<div id="ucitavanje-eksternih-podataka" class="section level2">
<h2><span class="header-section-number">3.3</span> Učitavanje eksternih podataka</h2>
<p>Prikažimo mogućnosti paketa <code>dplyr</code> kroz istraživanje podataka o životnom veku u državama, poteklih od Svetske zdravstvene organizacije. Podaci koje ćemo posmatrati su dostupni na <a href="https://www.kaggle.com/kumarajarshi/life-expectancy-who" class="uri">https://www.kaggle.com/kumarajarshi/life-expectancy-who</a>.</p>
<p>Kada preuzmemo podatke, učitavamo ih funkcijom <code>read.csv</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">who_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Life Expectancy Data.csv&quot;</span>)
who_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">15</span>) <span class="co"># stampamo 15 slucajno izabranih</span></code></pre>
<pre><code>##                             Country Year     Status Life.expectancy
## 1                      Saudi Arabia 2005 Developing            73.1
## 2          United States of America 2008  Developed            78.2
## 3                             Gabon 2004 Developing            59.7
## 4                  Papua New Guinea 2008 Developing            61.4
## 5                      South Africa 2005 Developing            53.8
## 6                            Sweden 2000  Developed            79.6
## 7                             Qatar 2006 Developing            76.6
## 8                            Norway 2007  Developed            85.0
## 9                            Sweden 2013  Developed            81.9
## 10      United Republic of Tanzania 2003 Developing            58.0
## 11                            Italy 2000  Developed            79.4
## 12                          Algeria 2011 Developing            74.9
## 13                             Mali 2000 Developing            49.8
## 14                       Azerbaijan 2003 Developing            67.8
## 15 Micronesia (Federated States of) 2007 Developing            68.2
##    Adult.Mortality infant.deaths Alcohol percentage.expenditure
## 1               11             9    0.05             1117.04813
## 2               18            27    8.74                0.00000
## 3              322             2    8.13              443.47506
## 4               29            11    0.81              103.72777
## 5              498            55    8.69              709.31710
## 6               73             0    6.20             3689.72730
## 7               83             0    1.28              448.59530
## 8               67             0    6.60            14829.41215
## 9               57             0    7.30             1212.66633
## 10             459           103    2.34                0.00000
## 11              77             3    9.78               31.50582
## 12             116            21    0.56              509.00204
## 13              37            60    0.47               23.94507
## 14             154             7    0.55               42.41491
## 15             175             0    1.64                0.00000
##    Hepatitis.B Measles  BMI under.five.deaths Polio Total.expenditure
## 1           97     373  6.2                10    96              3.42
## 2           94     140 65.7                31    94             16.20
## 3           NA      63  3.3                 3    44              3.26
## 4           59       0 43.4                14    76              4.60
## 5           79     615 43.6                84    75              7.77
## 6           NA      59 52.8                 0    99              8.18
## 7           96     144 65.0                 0    95              2.58
## 8           NA       0 57.5                 0    93              8.58
## 9           67      51 58.5                 0    98             11.97
## 10          95    1673 17.2               160    97              4.60
## 11          94    1457 55.0                 3    97              7.91
## 12          95     112 55.0                24    95              5.29
## 13          NA    1578 15.6               111    53              6.29
## 14          51    1978 43.6                 8    79              6.56
## 15           9       0 64.7                 0    79             11.99
##    Diphtheria HIV.AIDS        GDP Population thinness..1.19.years
## 1          96      0.1 13739.8294         NA                  7.2
## 2          96      0.1         NA         NA                  0.7
## 3          45     11.1  5685.5777   136425.0                  7.4
## 4          63      1.3  1178.7247  6787187.0                  1.4
## 5          79     29.5  5414.6343   476667.2                 11.6
## 6          99      0.1 29283.5500   887219.0                  1.4
## 7          96      0.1  6256.5593         NA                  4.9
## 8          93      0.1 85128.6576   479153.0                  0.7
## 9          98      0.1  6283.2452    96379.0                  1.4
## 10         95     11.5         NA         NA                  7.9
## 11         87      0.1   251.2426  5694218.0                  0.5
## 12         95      0.1  5432.2523 36819558.0                  5.9
## 13         43      2.5   269.3484   196769.0                 11.0
## 14         77      0.1   883.6440    82341.0                  3.0
## 15         79      0.1         NA         NA                  0.2
##    thinness.5.9.years Income.composition.of.resources Schooling
## 1                 7.3                           0.761      12.4
## 2                 0.6                              NA        NA
## 3                 7.2                           0.640      12.3
## 4                 1.3                           0.469       8.9
## 5                13.9                           0.609      12.9
## 6                 1.3                           0.873      15.9
## 7                 4.5                           0.835      13.7
## 8                 0.7                           0.934      17.6
## 9                 1.3                           0.904      15.8
## 10                7.9                              NA        NA
## 11                0.5                           0.823      14.8
## 12                5.8                           0.724      14.0
## 13                1.9                           0.291       4.4
## 14                3.0                           0.659      10.8
## 15                0.2                           0.625      11.0</code></pre>
<p>Paket <code>dplyr</code> koristi malo bogatiju strukturu umesto dataframe-a za tabelarne podatke, a to je tibble. Podatke pretvaramo u taj format na sledeći način:</p>
<pre class="sourceCode r"><code class="sourceCode r">who_data &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(who_data)
who_data</code></pre>
<pre><code>## # A tibble: 2,938 x 22
##    Country  Year Status Life.expectancy Adult.Mortality infant.deaths
##    &lt;fct&gt;   &lt;int&gt; &lt;fct&gt;            &lt;dbl&gt;           &lt;int&gt;         &lt;int&gt;
##  1 Afghan…  2015 Devel…            65               263            62
##  2 Afghan…  2014 Devel…            59.9             271            64
##  3 Afghan…  2013 Devel…            59.9             268            66
##  4 Afghan…  2012 Devel…            59.5             272            69
##  5 Afghan…  2011 Devel…            59.2             275            71
##  6 Afghan…  2010 Devel…            58.8             279            74
##  7 Afghan…  2009 Devel…            58.6             281            77
##  8 Afghan…  2008 Devel…            58.1             287            80
##  9 Afghan…  2007 Devel…            57.5             295            82
## 10 Afghan…  2006 Devel…            57.3             295            84
## # … with 2,928 more rows, and 16 more variables: Alcohol &lt;dbl&gt;,
## #   percentage.expenditure &lt;dbl&gt;, Hepatitis.B &lt;int&gt;, Measles &lt;int&gt;,
## #   BMI &lt;dbl&gt;, under.five.deaths &lt;int&gt;, Polio &lt;int&gt;,
## #   Total.expenditure &lt;dbl&gt;, Diphtheria &lt;int&gt;, HIV.AIDS &lt;dbl&gt;, GDP &lt;dbl&gt;,
## #   Population &lt;dbl&gt;, thinness..1.19.years &lt;dbl&gt;,
## #   thinness.5.9.years &lt;dbl&gt;, Income.composition.of.resources &lt;dbl&gt;,
## #   Schooling &lt;dbl&gt;</code></pre>
<p>Vidimo blage razlike u prikazu.</p>
<p>Korisno je pogledati podatke funkcijom <code>glimpse</code> (iz <code>dplyr</code>), gde vidimo tip promenljivih i prvih nekoliko podataka iz odgovarajuće kolone.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(who_data)</code></pre>
<pre><code>## Observations: 2,938
## Variables: 22
## $ Country                         &lt;fct&gt; Afghanistan, Afghanistan, Afghan…
## $ Year                            &lt;int&gt; 2015, 2014, 2013, 2012, 2011, 20…
## $ Status                          &lt;fct&gt; Developing, Developing, Developi…
## $ Life.expectancy                 &lt;dbl&gt; 65.0, 59.9, 59.9, 59.5, 59.2, 58…
## $ Adult.Mortality                 &lt;int&gt; 263, 271, 268, 272, 275, 279, 28…
## $ infant.deaths                   &lt;int&gt; 62, 64, 66, 69, 71, 74, 77, 80, …
## $ Alcohol                         &lt;dbl&gt; 0.01, 0.01, 0.01, 0.01, 0.01, 0.…
## $ percentage.expenditure          &lt;dbl&gt; 71.279624, 73.523582, 73.219243,…
## $ Hepatitis.B                     &lt;int&gt; 65, 62, 64, 67, 68, 66, 63, 64, …
## $ Measles                         &lt;int&gt; 1154, 492, 430, 2787, 3013, 1989…
## $ BMI                             &lt;dbl&gt; 19.1, 18.6, 18.1, 17.6, 17.2, 16…
## $ under.five.deaths               &lt;int&gt; 83, 86, 89, 93, 97, 102, 106, 11…
## $ Polio                           &lt;int&gt; 6, 58, 62, 67, 68, 66, 63, 64, 6…
## $ Total.expenditure               &lt;dbl&gt; 8.16, 8.18, 8.13, 8.52, 7.87, 9.…
## $ Diphtheria                      &lt;int&gt; 65, 62, 64, 67, 68, 66, 63, 64, …
## $ HIV.AIDS                        &lt;dbl&gt; 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.…
## $ GDP                             &lt;dbl&gt; 584.25921, 612.69651, 631.74498,…
## $ Population                      &lt;dbl&gt; 33736494, 327582, 31731688, 3696…
## $ thinness..1.19.years            &lt;dbl&gt; 17.2, 17.5, 17.7, 17.9, 18.2, 18…
## $ thinness.5.9.years              &lt;dbl&gt; 17.3, 17.5, 17.7, 18.0, 18.2, 18…
## $ Income.composition.of.resources &lt;dbl&gt; 0.479, 0.476, 0.470, 0.463, 0.45…
## $ Schooling                       &lt;dbl&gt; 10.1, 10.0, 9.9, 9.8, 9.5, 9.2, …</code></pre>
<p>Sumarne podatke po kolonama vidimo ugradjenom funkcijom <code>summary</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(who_data)</code></pre>
<pre><code>##                 Country          Year             Status    
##  Afghanistan        :  16   Min.   :2000   Developed : 512  
##  Albania            :  16   1st Qu.:2004   Developing:2426  
##  Algeria            :  16   Median :2008                    
##  Angola             :  16   Mean   :2008                    
##  Antigua and Barbuda:  16   3rd Qu.:2012                    
##  Argentina          :  16   Max.   :2015                    
##  (Other)            :2842                                   
##  Life.expectancy Adult.Mortality infant.deaths       Alcohol       
##  Min.   :36.30   Min.   :  1.0   Min.   :   0.0   Min.   : 0.0100  
##  1st Qu.:63.10   1st Qu.: 74.0   1st Qu.:   0.0   1st Qu.: 0.8775  
##  Median :72.10   Median :144.0   Median :   3.0   Median : 3.7550  
##  Mean   :69.22   Mean   :164.8   Mean   :  30.3   Mean   : 4.6029  
##  3rd Qu.:75.70   3rd Qu.:228.0   3rd Qu.:  22.0   3rd Qu.: 7.7025  
##  Max.   :89.00   Max.   :723.0   Max.   :1800.0   Max.   :17.8700  
##  NA&#39;s   :10      NA&#39;s   :10                       NA&#39;s   :194      
##  percentage.expenditure  Hepatitis.B       Measles              BMI       
##  Min.   :    0.000      Min.   : 1.00   Min.   :     0.0   Min.   : 1.00  
##  1st Qu.:    4.685      1st Qu.:77.00   1st Qu.:     0.0   1st Qu.:19.30  
##  Median :   64.913      Median :92.00   Median :    17.0   Median :43.50  
##  Mean   :  738.251      Mean   :80.94   Mean   :  2419.6   Mean   :38.32  
##  3rd Qu.:  441.534      3rd Qu.:97.00   3rd Qu.:   360.2   3rd Qu.:56.20  
##  Max.   :19479.912      Max.   :99.00   Max.   :212183.0   Max.   :87.30  
##                         NA&#39;s   :553                        NA&#39;s   :34     
##  under.five.deaths     Polio       Total.expenditure   Diphtheria   
##  Min.   :   0.00   Min.   : 3.00   Min.   : 0.370    Min.   : 2.00  
##  1st Qu.:   0.00   1st Qu.:78.00   1st Qu.: 4.260    1st Qu.:78.00  
##  Median :   4.00   Median :93.00   Median : 5.755    Median :93.00  
##  Mean   :  42.04   Mean   :82.55   Mean   : 5.938    Mean   :82.32  
##  3rd Qu.:  28.00   3rd Qu.:97.00   3rd Qu.: 7.492    3rd Qu.:97.00  
##  Max.   :2500.00   Max.   :99.00   Max.   :17.600    Max.   :99.00  
##                    NA&#39;s   :19      NA&#39;s   :226       NA&#39;s   :19     
##     HIV.AIDS           GDP              Population       
##  Min.   : 0.100   Min.   :     1.68   Min.   :3.400e+01  
##  1st Qu.: 0.100   1st Qu.:   463.94   1st Qu.:1.958e+05  
##  Median : 0.100   Median :  1766.95   Median :1.387e+06  
##  Mean   : 1.742   Mean   :  7483.16   Mean   :1.275e+07  
##  3rd Qu.: 0.800   3rd Qu.:  5910.81   3rd Qu.:7.420e+06  
##  Max.   :50.600   Max.   :119172.74   Max.   :1.294e+09  
##                   NA&#39;s   :448         NA&#39;s   :652        
##  thinness..1.19.years thinness.5.9.years Income.composition.of.resources
##  Min.   : 0.10        Min.   : 0.10      Min.   :0.0000                 
##  1st Qu.: 1.60        1st Qu.: 1.50      1st Qu.:0.4930                 
##  Median : 3.30        Median : 3.30      Median :0.6770                 
##  Mean   : 4.84        Mean   : 4.87      Mean   :0.6276                 
##  3rd Qu.: 7.20        3rd Qu.: 7.20      3rd Qu.:0.7790                 
##  Max.   :27.70        Max.   :28.60      Max.   :0.9480                 
##  NA&#39;s   :34           NA&#39;s   :34         NA&#39;s   :167                    
##    Schooling    
##  Min.   : 0.00  
##  1st Qu.:10.10  
##  Median :12.30  
##  Mean   :11.99  
##  3rd Qu.:14.30  
##  Max.   :20.70  
##  NA&#39;s   :163</code></pre>
</div>
<div id="osnovne-funkcije-paketa-dplyr" class="section level2">
<h2><span class="header-section-number">3.4</span> Osnovne funkcije paketa <code>dplyr</code></h2>
<p>Proći ćemo nekoliko primera osnovnih funkcija iz paketa. Najviše ćemo koristiti podatke iz paketa <code>nycflights13</code>, pa ga učitavamo</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nycflights13)</code></pre>
<p>Prelazimo na pregled funkcija.</p>
<div id="select---odabir-kolona" class="section level3">
<h3><span class="header-section-number">3.4.1</span> <code>select</code> - odabir kolona</h3>
<p>Sa ovom funkcijom smo se već susreli i nećemo dužiti. Ona služi da iz tabele koja ima mnogo kolona odaberemo samo one koje su nam od interesa, radi lakšeg pregleda.</p>
<p>Odaberimo iz baze <code>flights</code> samo kolone godina, mesec, dan, polazipte i destinacija.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(year, month, day, origin, dest)</code></pre>
<pre><code>## # A tibble: 336,776 x 5
##     year month   day origin dest 
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;
##  1  2013     1     1 EWR    IAH  
##  2  2013     1     1 LGA    IAH  
##  3  2013     1     1 JFK    MIA  
##  4  2013     1     1 JFK    BQN  
##  5  2013     1     1 LGA    ATL  
##  6  2013     1     1 EWR    ORD  
##  7  2013     1     1 EWR    FLL  
##  8  2013     1     1 LGA    IAD  
##  9  2013     1     1 JFK    MCO  
## 10  2013     1     1 LGA    ORD  
## # … with 336,766 more rows</code></pre>
</div>
<div id="filter---filtriranje-redova" class="section level3">
<h3><span class="header-section-number">3.4.2</span> <code>filter</code> - Filtriranje redova</h3>
<p>Ova funkcija služi za odabir odgovarajućih vrsta tabele, tj. opservacija, na osnovu željenih kriterijuma.</p>
<p>Kao primer, možemo da izdvojimo iz baze letova one letove koji idu ka Portlandu, sa kodom aerodroma <code>&quot;PDX&quot;</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">portland_flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(dest <span class="op">==</span><span class="st"> &quot;PDX&quot;</span>)
<span class="co">#View(portland_flights)</span></code></pre>
<p>Kao argument funkciji <code>filter</code> prosledjuje se uslov koji želimo da ispunjavaju redovi koje biramo. To je zapravo vektor <code>TRUE</code> i <code>FALSE</code> vrednosti, kao kod indeksiranja klasičnog dataframe-a. Ovde smo koristili operator jednakosti <code>==</code>, ali možemo koristiti i druge matematičke operatore poput <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>. Više kriterijuma možemo spajati operatorima konjukcije <code>&amp;</code> (‘i’) i disjunkcije <code>|</code> (‘ili’). Naravno, pored ovih, mogu se koristiti bilo koje funkcije koje daju kao rezultat logičke vektore.</p>
<p>Na primer, možemo da odaberemo letove koji kreću sa aerodroma JFK, a leteli su duže od sat vremena.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(origin <span class="op">==</span><span class="st"> &quot;JFK&quot;</span> <span class="op">&amp;</span><span class="st"> </span>air_time <span class="op">&gt;</span><span class="st"> </span><span class="dv">60</span>)</code></pre>
<pre><code>## # A tibble: 86,058 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
##  1  2013     1     1      542            540         2      923
##  2  2013     1     1      544            545        -1     1004
##  3  2013     1     1      557            600        -3      838
##  4  2013     1     1      558            600        -2      849
##  5  2013     1     1      558            600        -2      853
##  6  2013     1     1      558            600        -2      924
##  7  2013     1     1      606            610        -4      837
##  8  2013     1     1      611            600        11      945
##  9  2013     1     1      613            610         3      925
## 10  2013     1     1      615            615         0     1039
## # … with 86,048 more rows, and 12 more variables: sched_arr_time &lt;int&gt;,
## #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
## #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
## #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Odredimo sve letove sa JFK do Berlingtona (BTV) i Sijetla (SEA), koji su od oktobra do kraja godine.</p>
<pre class="sourceCode r"><code class="sourceCode r">btv_sea_flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(origin <span class="op">==</span><span class="st"> &quot;JFK&quot;</span> <span class="op">&amp;</span><span class="st"> </span>(dest <span class="op">==</span><span class="st"> &quot;BTV&quot;</span> <span class="op">|</span><span class="st"> </span>dest <span class="op">==</span><span class="st"> &quot;SEA&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>month <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>)
<span class="co">#View(btv_sea_flights)</span></code></pre>
<p>Umesto korišćenja operatora konjunkcije, možemo samo razdvojiti sve uslove koji moraju biti zadovoljeni sa zapetom.</p>
<pre class="sourceCode r"><code class="sourceCode r">btv_sea_flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(origin <span class="op">==</span><span class="st"> &quot;JFK&quot;</span>, (dest <span class="op">==</span><span class="st"> &quot;BTV&quot;</span> <span class="op">|</span><span class="st"> </span>dest <span class="op">==</span><span class="st"> &quot;SEA&quot;</span>), month <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>)
<span class="co">#View(btv_sea_flights)</span></code></pre>
</div>
<div id="arrange---sortiranje-redova" class="section level3">
<h3><span class="header-section-number">3.4.3</span> <code>arrange</code> - sortiranje redova</h3>
<p>Često ima smisla sortirati podatke u odnosu na neku kolonu prilikom istraživanja podataka. Paket <code>dplyr</code> nam daje jednostavan način za to kroz funkciju <code>arrange</code>. Par jednostavnih primera sledi.</p>
<p>Sortirajmo letove po trajanju leta rastuće…</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(air_time) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, air_time)</code></pre>
<pre><code>## # A tibble: 336,776 x 2
##    tailnum air_time
##    &lt;chr&gt;      &lt;dbl&gt;
##  1 N16911        20
##  2 N12167        20
##  3 N27200        21
##  4 N13913        21
##  5 N13955        21
##  6 N12921        21
##  7 N947UW        21
##  8 N8501F        21
##  9 N12160        21
## 10 N16987        21
## # … with 336,766 more rows</code></pre>
<p>… ili opadajuće</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(air_time)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, air_time)</code></pre>
<pre><code>## # A tibble: 336,776 x 2
##    tailnum air_time
##    &lt;chr&gt;      &lt;dbl&gt;
##  1 N77066       695
##  2 N389HA       691
##  3 N388HA       686
##  4 N380HA       686
##  5 N384HA       683
##  6 N386HA       679
##  7 N59053       676
##  8 N380HA       676
##  9 N386HA       675
## 10 N76065       671
## # … with 336,766 more rows</code></pre>
<p>Vrlo korisna opcija je što se sortiranje može vršiti po više promenljivih. Na primer, da bismo sortirali letove po datumu leta, počevši od najskorijeg, treba da sortiramo prvo opadajuće po mesecu, ali i one iz istog meseca treba sortirati opadajuće po danu. Ovo radimo na sledeći način</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># radi lakseg pregleda, uzecemo podskup od</span>
<span class="co"># 10 letova</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
subflights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>) 
subflights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(month), <span class="kw">desc</span>(day)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, month, day)</code></pre>
<pre><code>## # A tibble: 10 x 3
##    tailnum month   day
##    &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
##  1 N855UA      9    25
##  2 N624JB      8    16
##  3 N725MQ      7    22
##  4 N328AA      3     7
##  5 N13716      2    15
##  6 N176PQ      2     7
##  7 N756US      1    30
##  8 N14237      1    29
##  9 &lt;NA&gt;        1    29
## 10 N10156      1    16</code></pre>
<p><strong>Napomena!</strong> Obratite pažnju, bitan je redosled argumenata u <code>arrange</code>, ako sortiramo prvo po danu pa po mesecu, ne dobijamo željeni rezultat.</p>
<pre class="sourceCode r"><code class="sourceCode r">subflights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(day), <span class="kw">desc</span>(month)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, month, day)</code></pre>
<pre><code>## # A tibble: 10 x 3
##    tailnum month   day
##    &lt;chr&gt;   &lt;int&gt; &lt;int&gt;
##  1 N756US      1    30
##  2 N14237      1    29
##  3 &lt;NA&gt;        1    29
##  4 N855UA      9    25
##  5 N725MQ      7    22
##  6 N624JB      8    16
##  7 N10156      1    16
##  8 N13716      2    15
##  9 N328AA      3     7
## 10 N176PQ      2     7</code></pre>
<p>Sortirajmo letove opadajuće po datumu, ali rastuće po trajanju leta</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(month), <span class="kw">desc</span>(day), air_time) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, month, day, air_time)</code></pre>
<pre><code>## # A tibble: 336,776 x 4
##    tailnum month   day air_time
##    &lt;chr&gt;   &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
##  1 N952UW     12    31       28
##  2 N13975     12    31       29
##  3 N197JB     12    31       32
##  4 N304JB     12    31       32
##  5 N76514     12    31       32
##  6 N236JB     12    31       32
##  7 N329JB     12    31       33
##  8 N351JB     12    31       33
##  9 N3JAAA     12    31       33
## 10 N206JB     12    31       33
## # … with 336,766 more rows</code></pre>
</div>
<div id="mutate---dodavanje-nove-kolone" class="section level3">
<h3><span class="header-section-number">3.4.4</span> <code>mutate</code> - dodavanje nove kolone</h3>
<p>Ovom funkcijom možemo da napravimo nove kolone koristeći postojeće. Na primer, možemo da vršimo konverziju iz Farenhajta u Celzijus.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ovako smo ranije</span>
<span class="co"># weather$celsius &lt;- (weather$temp - 32) * 5 / 9</span>

<span class="co"># dplyr nacin:</span>
weather &lt;-<span class="st"> </span>weather <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">celsius =</span> (temp <span class="op">-</span><span class="st"> </span><span class="dv">32</span>) <span class="op">*</span><span class="st"> </span><span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">9</span>)

<span class="co">#View(weather)</span></code></pre>
<p>Možemo praviti više novih kolona odjednom. Na primer, dodaćemo kolonu “gain” koja predstavlja razliku izmedju kašnjenja polaska i kašnjenja dolaska, tj. neki vid nadoknadjenog vremena kada je let kasnio sa polaskom. Pored toga, dodaćemo kolonu koja predstavlja let u satima, i odrediti i “gain” po satu.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">gain =</span> dep_delay <span class="op">-</span><span class="st"> </span>arr_delay,
    <span class="dt">hours =</span> air_time <span class="op">/</span><span class="st"> </span><span class="dv">60</span>,
    <span class="dt">gain_per_hour =</span> gain <span class="op">/</span><span class="st"> </span>hours
  )</code></pre>
<p>I sortiramo po <code>gain_per_hour</code></p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(gain_per_hour) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(dep_delay, arr_delay, gain, hours, air_time, gain_per_hour)</code></pre>
<pre><code>## # A tibble: 336,776 x 6
##    dep_delay arr_delay  gain hours air_time gain_per_hour
##        &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;
##  1       171       273  -102 0.517       31         -197.
##  2        62       177  -115 0.6         36         -192.
##  3        11       122  -111 0.6         36         -185 
##  4       115       233  -118 0.667       40         -177 
##  5        -7       106  -113 0.65        39         -174.
##  6        -8       123  -131 0.767       46         -171.
##  7        -1       109  -110 0.65        39         -169.
##  8        39       152  -113 0.7         42         -161.
##  9         3        94   -91 0.567       34         -161.
## 10        33       136  -103 0.65        39         -158.
## # … with 336,766 more rows</code></pre>
<p>Ako uposlimo i paket <code>lubridate</code>, koji značajno olakšava rad sa datumima u R-u, možemo dodati i kolonu koja sadrži tačno vreme leta, umesto komponenti koje imamo sada.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;lubridate&quot;)</span>
<span class="kw">library</span>(lubridate)

flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">departure =</span> <span class="kw">make_datetime</span>(year, month, day, hour, minute))

flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(year, month, day, hour, minute, departure)</code></pre>
<pre><code>## # A tibble: 336,776 x 6
##     year month   day  hour minute departure          
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dttm&gt;             
##  1  2013     1     1     5     15 2013-01-01 05:15:00
##  2  2013     1     1     5     29 2013-01-01 05:29:00
##  3  2013     1     1     5     40 2013-01-01 05:40:00
##  4  2013     1     1     5     45 2013-01-01 05:45:00
##  5  2013     1     1     6      0 2013-01-01 06:00:00
##  6  2013     1     1     5     58 2013-01-01 05:58:00
##  7  2013     1     1     6      0 2013-01-01 06:00:00
##  8  2013     1     1     6      0 2013-01-01 06:00:00
##  9  2013     1     1     6      0 2013-01-01 06:00:00
## 10  2013     1     1     6      0 2013-01-01 06:00:00
## # … with 336,766 more rows</code></pre>
<p>Sada prethodno sortiranje opadajuće možemo odratiti po toj novoj koloni.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(departure)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, month, day, departure)</code></pre>
<pre><code>## # A tibble: 10 x 4
##    tailnum month   day departure          
##    &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;dttm&gt;             
##  1 N855UA      9    25 2013-09-25 14:17:00
##  2 N624JB      8    16 2013-08-16 12:41:00
##  3 N725MQ      7    22 2013-07-22 08:30:00
##  4 N328AA      3     7 2013-03-07 21:35:00
##  5 N13716      2    15 2013-02-15 20:48:00
##  6 N176PQ      2     7 2013-02-07 06:15:00
##  7 N756US      1    30 2013-01-30 08:00:00
##  8 &lt;NA&gt;        1    29 2013-01-29 19:00:00
##  9 N14237      1    29 2013-01-29 07:15:00
## 10 N10156      1    16 2013-01-16 19:35:00</code></pre>
<p>Specijalan slučaj <code>mutate</code> naredbe je <code>rename</code> koju koristimo za preimenovanje kolona.</p>
<pre class="sourceCode r"><code class="sourceCode r">weather <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">temp_C =</span> celsius)</code></pre>
<pre><code>## # A tibble: 26,115 x 16
##    origin  year month   day  hour  temp  dewp humid wind_dir wind_speed
##    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4 
##  2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06
##  3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5 
##  4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7 
##  5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7 
##  6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5 
##  7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0 
##  8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4 
##  9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0 
## 10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8 
## # … with 26,105 more rows, and 6 more variables: wind_gust &lt;dbl&gt;,
## #   precip &lt;dbl&gt;, pressure &lt;dbl&gt;, visib &lt;dbl&gt;, time_hour &lt;dttm&gt;,
## #   temp_C &lt;dbl&gt;</code></pre>
</div>
<div id="summarise---sumarne-statistike" class="section level3">
<h3><span class="header-section-number">3.4.5</span> <code>summarise</code> - sumarne statistike</h3>
<p>Ova, jedna od korisnijih funkcija, služi za računanje neke statistike nad podacima. Podaci mogu biti i grupisani, što ćemo videti kasnije. Za početak, vidimo neki prosti primer.</p>
<p>Prosečno vreme trajanja letova dobijamo ovako:</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="kw">mean</span>(air_time))</code></pre>
<pre><code>## # A tibble: 1 x 1
##   `mean(air_time)`
##              &lt;dbl&gt;
## 1               NA</code></pre>
<p>Ima NA vrednosti, pa dodajemo <code>na.rm = TRUE</code>, da bi ih ignorisali prilikom računa.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="kw">mean</span>(air_time, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre>
<pre><code>## # A tibble: 1 x 1
##   `mean(air_time, na.rm = TRUE)`
##                            &lt;dbl&gt;
## 1                           151.</code></pre>
<p>Da vidimo i ukupan broj letova, koristimo specijalnu funkciju <code>n()</code>. Dodajmo i kvantile iz poziva <code>summary</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">no_na_flights &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(air_time))

no_na_flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(
    <span class="dt">count =</span> <span class="kw">n</span>(),
    <span class="dt">min_time =</span> <span class="kw">min</span>(air_time),
    <span class="dt">time_q1 =</span> <span class="kw">quantile</span>(air_time, <span class="fl">0.25</span>),
    <span class="dt">median_time =</span> <span class="kw">median</span>(air_time),
    <span class="dt">mean_time =</span> <span class="kw">mean</span>(air_time),
    <span class="dt">time_13 =</span> <span class="kw">quantile</span>(air_time, <span class="fl">0.75</span>),
    <span class="dt">max_time =</span> <span class="kw">max</span>(air_time)
  )</code></pre>
<pre><code>## # A tibble: 1 x 7
##    count min_time time_q1 median_time mean_time time_13 max_time
##    &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1 327346       20      82         129      151.     192      695</code></pre>
<p>Vidimo poklapanje sa <code>summary</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(no_na_flights<span class="op">$</span>air_time)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    20.0    82.0   129.0   150.7   192.0   695.0</code></pre>
</div>
<div id="group_by---grupisanje-opservacija" class="section level3">
<h3><span class="header-section-number">3.4.6</span> <code>group_by</code> - grupisanje opservacija</h3>
<p>Često je potrebno, posebno za sumarizavije, da grupišemo podatke u odnosu na neku promenljivu, da bismo videli svojstva odgovarajućih grupa. Na primer, možda želimo da vidimo prosečnu temperaturu po mesecima iz skupa podataka <code>weather</code>, umesto sveukupnog proseka temperature u celoj tabeli. To radimo uz pomoć funkcije <code>group_by</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nycflights13)
<span class="kw">library</span>(dplyr)
weather <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_temp =</span> <span class="kw">mean</span>(temp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">stdev_temp =</span> <span class="kw">sd</span>(temp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre>
<pre><code>## # A tibble: 12 x 3
##    month mean_temp stdev_temp
##    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
##  1     1      35.6      10.2 
##  2     2      34.3       6.98
##  3     3      39.9       6.25
##  4     4      51.7       8.79
##  5     5      61.8       9.68
##  6     6      72.2       7.55
##  7     7      80.1       7.12
##  8     8      74.5       5.19
##  9     9      67.4       8.47
## 10    10      60.1       8.85
## 11    11      45.0      10.4 
## 12    12      38.4       9.98</code></pre>
<p>Ovo naravno možemo i prikazati grafiički pomoću bar plota.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
weather <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_temp =</span> <span class="kw">mean</span>(temp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
            <span class="dt">stdev_temp =</span> <span class="kw">sd</span>(temp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> mean_temp)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_col</span>()</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<p>Analizirajmo malo dijamante. U <code>ggplot2</code> paketu postoji skup podataka <code>diamonds</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">diamonds</code></pre>
<pre><code>## # A tibble: 53,940 x 10
##    carat cut       color clarity depth table price     x     y     z
##    &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 0.23  Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43
##  2 0.21  Premium   E     SI1      59.8    61   326  3.89  3.84  2.31
##  3 0.23  Good      E     VS1      56.9    65   327  4.05  4.07  2.31
##  4 0.290 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63
##  5 0.31  Good      J     SI2      63.3    58   335  4.34  4.35  2.75
##  6 0.24  Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48
##  7 0.24  Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47
##  8 0.26  Very Good H     SI1      61.9    55   337  4.07  4.11  2.53
##  9 0.22  Fair      E     VS2      65.1    61   337  3.87  3.78  2.49
## 10 0.23  Very Good H     VS1      59.4    61   338  4     4.05  2.39
## # … with 53,930 more rows</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(diamonds)</code></pre>
<pre><code>## Observations: 53,940
## Variables: 10
## $ carat   &lt;dbl&gt; 0.23, 0.21, 0.23, 0.29, 0.31, 0.24, 0.24, 0.26, 0.22, 0.…
## $ cut     &lt;ord&gt; Ideal, Premium, Good, Premium, Good, Very Good, Very Goo…
## $ color   &lt;ord&gt; E, E, E, I, J, J, I, H, E, H, J, J, F, J, E, E, I, J, J,…
## $ clarity &lt;ord&gt; SI2, SI1, VS1, VS2, SI2, VVS2, VVS1, SI1, VS2, VS1, SI1,…
## $ depth   &lt;dbl&gt; 61.5, 59.8, 56.9, 62.4, 63.3, 62.8, 62.3, 61.9, 65.1, 59…
## $ table   &lt;dbl&gt; 55, 61, 65, 58, 58, 57, 57, 55, 61, 61, 55, 56, 61, 54, …
## $ price   &lt;int&gt; 326, 326, 327, 334, 335, 336, 336, 337, 337, 338, 339, 3…
## $ x       &lt;dbl&gt; 3.95, 3.89, 4.05, 4.20, 4.34, 3.94, 3.95, 4.07, 3.87, 4.…
## $ y       &lt;dbl&gt; 3.98, 3.84, 4.07, 4.23, 4.35, 3.96, 3.98, 4.11, 3.78, 4.…
## $ z       &lt;dbl&gt; 2.43, 2.31, 2.31, 2.63, 2.75, 2.48, 2.47, 2.53, 2.49, 2.…</code></pre>
<p>Pogledajmo cenu u zavisnosti kvaliteta (promenljiva <code>cut</code>)</p>
<pre class="sourceCode r"><code class="sourceCode r">diamonds <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(cut) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">avg_price =</span> <span class="kw">mean</span>(price))</code></pre>
<pre><code>## # A tibble: 5 x 2
##   cut       avg_price
##   &lt;ord&gt;         &lt;dbl&gt;
## 1 Fair          4359.
## 2 Good          3929.
## 3 Very Good     3982.
## 4 Premium       4584.
## 5 Ideal         3458.</code></pre>
<p>Pogledajmo malo kako radi <code>group_by</code>. Ideja je da od originalnog dataframe-a napravi grupisani dataframe kod koga se operacije primenjuju na svaku grupu ponaosob, umesto kolektivno na celu tabelu.</p>
<pre class="sourceCode r"><code class="sourceCode r">diamonds_by_cut &lt;-<span class="st"> </span>diamonds <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cut)
diamonds_by_cut</code></pre>
<pre><code>## # A tibble: 53,940 x 10
## # Groups:   cut [5]
##    carat cut       color clarity depth table price     x     y     z
##    &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 0.23  Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43
##  2 0.21  Premium   E     SI1      59.8    61   326  3.89  3.84  2.31
##  3 0.23  Good      E     VS1      56.9    65   327  4.05  4.07  2.31
##  4 0.290 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63
##  5 0.31  Good      J     SI2      63.3    58   335  4.34  4.35  2.75
##  6 0.24  Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48
##  7 0.24  Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47
##  8 0.26  Very Good H     SI1      61.9    55   337  4.07  4.11  2.53
##  9 0.22  Fair      E     VS2      65.1    61   337  3.87  3.78  2.49
## 10 0.23  Very Good H     VS1      59.4    61   338  4     4.05  2.39
## # … with 53,930 more rows</code></pre>
<p>Ovaj dataframe je u suštini isti kao ranije, samo što je naznačeno da se grupiše po promenljivoj <code>cut</code>.
Svaka operacija se sada na ovaj dataframe primenjuje na svaku grupu, npr, da vidimo broj elemenata:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># grupisano</span>
diamonds_by_cut <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="kw">n</span>())</code></pre>
<pre><code>## # A tibble: 5 x 2
##   cut       `n()`
##   &lt;ord&gt;     &lt;int&gt;
## 1 Fair       1610
## 2 Good       4906
## 3 Very Good 12082
## 4 Premium   13791
## 5 Ideal     21551</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># negrupisano</span>
diamonds <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># moze i ungroup(diamonds_by_cut)</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="kw">n</span>())</code></pre>
<pre><code>## # A tibble: 1 x 1
##   `n()`
##   &lt;int&gt;
## 1 53940</code></pre>
<p>Nisu sumarizacije jedina opcija. Možemo i odabrati podatak kod koga je najveća cena u svakoj grupi.</p>
<pre class="sourceCode r"><code class="sourceCode r">diamonds_by_cut <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(price <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(price))</code></pre>
<pre><code>## # A tibble: 5 x 10
## # Groups:   cut [5]
##   carat cut       color clarity depth table price     x     y     z
##   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  2.01 Fair      G     SI1      70.6    64 18574  7.43  6.64  4.69
## 2  2.8  Good      G     SI2      63.8    58 18788  8.9   8.85  0   
## 3  1.51 Ideal     G     IF       61.7    55 18806  7.37  7.41  4.56
## 4  2    Very Good G     SI1      63.5    56 18818  7.9   7.97  5.04
## 5  2.29 Premium   I     VS2      60.8    60 18823  8.5   8.47  5.16</code></pre>
<p>Primetimo, ovde biramo celu vrstu, ne gledamo samo koliki je maksimum.</p>
<p>Dakle, možemo i filtrirati po grupama. Uzmimo iz svake grupe 0.0001% najskupljih.</p>
<pre class="sourceCode r"><code class="sourceCode r">diamonds_by_cut <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(price <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(price, <span class="fl">0.9999</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(cut)</code></pre>
<pre><code>## # A tibble: 9 x 10
## # Groups:   cut [5]
##   carat cut       color clarity depth table price     x     y     z
##   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  2.01 Fair      G     SI1      70.6    64 18574  7.43  6.64  4.69
## 2  2.8  Good      G     SI2      63.8    58 18788  8.9   8.85  0   
## 3  2    Very Good H     SI1      62.8    57 18803  7.95  8     5.01
## 4  2    Very Good G     SI1      63.5    56 18818  7.9   7.97  5.04
## 5  2.29 Premium   I     SI1      61.8    59 18797  8.52  8.45  5.24
## 6  2.29 Premium   I     VS2      60.8    60 18823  8.5   8.47  5.16
## 7  2.15 Ideal     G     SI2      62.6    54 18791  8.29  8.35  5.21
## 8  2.07 Ideal     G     SI2      62.5    55 18804  8.2   8.13  5.11
## 9  1.51 Ideal     G     IF       61.7    55 18806  7.37  7.41  4.56</code></pre>
<p>Vidimo da ovo nije isto kao negrupisani poziv, gde su <code>&quot;Fair&quot;</code> i <code>&quot;Good&quot;</code> kvaliteti izostavljeni.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ungroup</span>(diamonds_by_cut) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(price <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(price, <span class="fl">0.9999</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(cut)</code></pre>
<pre><code>## # A tibble: 6 x 10
##   carat cut       color clarity depth table price     x     y     z
##   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  2    Very Good H     SI1      62.8    57 18803  7.95  8     5.01
## 2  2    Very Good G     SI1      63.5    56 18818  7.9   7.97  5.04
## 3  2.29 Premium   I     SI1      61.8    59 18797  8.52  8.45  5.24
## 4  2.29 Premium   I     VS2      60.8    60 18823  8.5   8.47  5.16
## 5  2.07 Ideal     G     SI2      62.5    55 18804  8.2   8.13  5.11
## 6  1.51 Ideal     G     IF       61.7    55 18806  7.37  7.41  4.56</code></pre>
<p>Bolje od kvantila je da koristimo funkciju <code>top_n</code>, za top 2 najskuplja po kvalitetu</p>
<pre class="sourceCode r"><code class="sourceCode r">diamonds_by_cut <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">2</span>, price) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(cut)</code></pre>
<pre><code>## # A tibble: 10 x 10
## # Groups:   cut [5]
##    carat cut       color clarity depth table price     x     y     z
##    &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  2.02 Fair      H     VS2      64.5    57 18565  8     7.95  5.14
##  2  2.01 Fair      G     SI1      70.6    64 18574  7.43  6.64  4.69
##  3  2.07 Good      I     VS2      61.8    61 18707  8.12  8.16  5.03
##  4  2.8  Good      G     SI2      63.8    58 18788  8.9   8.85  0   
##  5  2    Very Good H     SI1      62.8    57 18803  7.95  8     5.01
##  6  2    Very Good G     SI1      63.5    56 18818  7.9   7.97  5.04
##  7  2.29 Premium   I     SI1      61.8    59 18797  8.52  8.45  5.24
##  8  2.29 Premium   I     VS2      60.8    60 18823  8.5   8.47  5.16
##  9  2.07 Ideal     G     SI2      62.5    55 18804  8.2   8.13  5.11
## 10  1.51 Ideal     G     IF       61.7    55 18806  7.37  7.41  4.56</code></pre>
<p>Poput sortiranja, i grupisanje se može vršiti po više promenljivih. Na primer, da se vratimo na naše avione, možemo da proverimo koliko je letova bilo u svakom mesecu, ali i njih da grupišemo po aerodromima sa kog su poleteli.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(origin, month) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>())</code></pre>
<pre><code>## # A tibble: 36 x 3
## # Groups:   origin [3]
##    origin month count
##    &lt;chr&gt;  &lt;int&gt; &lt;int&gt;
##  1 EWR        1  9893
##  2 EWR        2  9107
##  3 EWR        3 10420
##  4 EWR        4 10531
##  5 EWR        5 10592
##  6 EWR        6 10175
##  7 EWR        7 10475
##  8 EWR        8 10359
##  9 EWR        9  9550
## 10 EWR       10 10104
## # … with 26 more rows</code></pre>
<p>Možemo i izdvojiti 3 najprometnija meseca za svaki aerodrom.</p>
<pre class="sourceCode r"><code class="sourceCode r">flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(origin, month) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">3</span>, count)</code></pre>
<pre><code>## # A tibble: 9 x 3
## # Groups:   origin [3]
##   origin month count
##   &lt;chr&gt;  &lt;int&gt; &lt;int&gt;
## 1 EWR        4 10531
## 2 EWR        5 10592
## 3 EWR        7 10475
## 4 JFK        3  9697
## 5 JFK        7 10023
## 6 JFK        8  9983
## 7 LGA        9  9116
## 8 LGA       10  9642
## 9 LGA       12  9067</code></pre>
<p>Kako ovo radi? Prilikom prvog poziva <code>summarise</code> “skinuli” smo zadnji sloj grupisanja, pa smo dobili dataframe grupisan samo po <code>origin</code>, pa na njemu <code>top_n</code> radi po grupama za polazni aerordrom. Stoga je bitan redosled grupisanja za ovakve operacije.</p>
</div>
<div id="join---spajanje-tabela" class="section level3">
<h3><span class="header-section-number">3.4.7</span> <code>join</code> - spajanje tabela</h3>
<p>Kada radimo sa dva povezana skupa podataka, nailazićemo na promenljive koje postoje u oba i po kojima bismo mogli ta dva skupa da spojimo u jednu tabelu. Dobar i dosta dublji tutorijal za join operacije je u okviru knjige R for Data Science, na <a href="https://r4ds.had.co.nz/relational-data.html#mutating-joins">ovom linku</a>.</p>
<p>Na primer, ako pogledamo tabele <code>airlines</code> i <code>flights</code></p>
<pre class="sourceCode r"><code class="sourceCode r">airlines</code></pre>
<pre><code>## # A tibble: 16 x 2
##    carrier name                       
##    &lt;chr&gt;   &lt;chr&gt;                      
##  1 9E      Endeavor Air Inc.          
##  2 AA      American Airlines Inc.     
##  3 AS      Alaska Airlines Inc.       
##  4 B6      JetBlue Airways            
##  5 DL      Delta Air Lines Inc.       
##  6 EV      ExpressJet Airlines Inc.   
##  7 F9      Frontier Airlines Inc.     
##  8 FL      AirTran Airways Corporation
##  9 HA      Hawaiian Airlines Inc.     
## 10 MQ      Envoy Air                  
## 11 OO      SkyWest Airlines Inc.      
## 12 UA      United Air Lines Inc.      
## 13 US      US Airways Inc.            
## 14 VX      Virgin America             
## 15 WN      Southwest Airlines Co.     
## 16 YV      Mesa Airlines Inc.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">flights</code></pre>
<pre><code>## # A tibble: 336,776 x 23
##     year month   day dep_time sched_dep_time dep_delay arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
##  1  2013     1     1      517            515         2      830
##  2  2013     1     1      533            529         4      850
##  3  2013     1     1      542            540         2      923
##  4  2013     1     1      544            545        -1     1004
##  5  2013     1     1      554            600        -6      812
##  6  2013     1     1      554            558        -4      740
##  7  2013     1     1      555            600        -5      913
##  8  2013     1     1      557            600        -3      709
##  9  2013     1     1      557            600        -3      838
## 10  2013     1     1      558            600        -2      753
## # … with 336,766 more rows, and 16 more variables: sched_arr_time &lt;int&gt;,
## #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;,
## #   origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;,
## #   minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, gain &lt;dbl&gt;, hours &lt;dbl&gt;,
## #   gain_per_hour &lt;dbl&gt;, departure &lt;dttm&gt;</code></pre>
<p>vidimo da imaju kolonu <code>carrier</code> koja označava skraćenicu avio kompanije. Možemo dodati u tabelu flights puno ime avio kompanije koristeći informaciju u tabeli <code>airlines</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">full_airline &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">inner_join</span>(airlines, <span class="dt">by =</span> <span class="st">&quot;carrier&quot;</span>)
full_airline <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(tailnum, carrier, name)</code></pre>
<pre><code>## # A tibble: 336,776 x 3
##    tailnum carrier name                    
##    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                   
##  1 N14228  UA      United Air Lines Inc.   
##  2 N24211  UA      United Air Lines Inc.   
##  3 N619AA  AA      American Airlines Inc.  
##  4 N804JB  B6      JetBlue Airways         
##  5 N668DN  DL      Delta Air Lines Inc.    
##  6 N39463  UA      United Air Lines Inc.   
##  7 N516JB  B6      JetBlue Airways         
##  8 N829AS  EV      ExpressJet Airlines Inc.
##  9 N593JB  B6      JetBlue Airways         
## 10 N3ALAA  AA      American Airlines Inc.  
## # … with 336,766 more rows</code></pre>
<p>Iskoristili smo funkciju <code>inner_join</code> ovaj put. Postoji više <code>*_join</code> funkcija u <code>dplyr</code> paketu, koje odgovaraju onima iz SQL jezika. Takodje, ova operacija je toliko popularna u SQL-u, da ima svoju adresu: <a href="http://www.sql-join.com/" class="uri">http://www.sql-join.com/</a> (koja se može koristiti za razumevanje).</p>
<p>Glavna razlika medju <code>*_join</code> funkcijama je:</p>
<ul>
<li><code>inner_join</code> zadržava samo one redove za koje u obe tabele postoji vrednost, tj. koje je mogao da upari sa redovima iz druge tabele.</li>
<li><code>left_join</code> zadržava sve redove iz prve tabele, a tamo gde nema para stavi NA</li>
<li><code>right_join</code> zadržava sve redove iz druge tabele</li>
<li><code>full_join</code> zadržava sve redove iz obe tabele</li>
</ul>
<p>Na sledećoj slici vidi se grafički prikaz ovih operacija.</p>
<div class="figure">
<img src="joins.png" alt="Ilustracije raznih join operacija. Preuzeto sa https://r4ds.had.co.nz." style="width:50.0%" />
<p class="caption"><em>Ilustracije raznih join operacija. Preuzeto sa <a href="https://r4ds.had.co.nz" class="uri">https://r4ds.had.co.nz</a>.</em></p>
</div>
<p>Dakle, kod nas je više smisla imalo koristiti <code>left_join</code>, iako je isti rezultat ovaj put.</p>
<pre class="sourceCode r"><code class="sourceCode r">full_airline &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(airlines, <span class="dt">by =</span> <span class="st">&quot;carrier&quot;</span>)</code></pre>
<p>Pokazaćemo sada na primeru razlike izmedju ovih raznih vrsta join operacije. Koristimo primere preuzete sa uputstva na stranici <a href="https://stat545.com/bit001_dplyr-cheatsheet.html" class="uri">https://stat545.com/bit001_dplyr-cheatsheet.html</a>.</p>
<p>Prvo kreiramo tabele</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
superheroes &lt;-<span class="st"> &quot;</span>
<span class="st">    name, alignment, gender,         publisher</span>
<span class="st"> Magneto,       bad,   male,            Marvel</span>
<span class="st">   Storm,      good, female,            Marvel</span>
<span class="st">Mystique,       bad, female,            Marvel</span>
<span class="st">  Batman,      good,   male,                DC</span>
<span class="st">   Joker,       bad,   male,                DC</span>
<span class="st">Catwoman,       bad, female,                DC</span>
<span class="st"> Hellboy,      good,   male, Dark Horse Comics</span>
<span class="st">&quot;</span>
superheroes &lt;-<span class="st"> </span><span class="kw">read_csv</span>(superheroes, <span class="dt">skip =</span> <span class="dv">1</span>)

publishers &lt;-<span class="st"> &quot;</span>
<span class="st">  publisher, yr_founded</span>
<span class="st">         DC,       1934</span>
<span class="st">     Marvel,       1939</span>
<span class="st">      Image,       1992</span>
<span class="st">&quot;</span>
publishers &lt;-<span class="st"> </span><span class="kw">read_csv</span>(publishers, <span class="dt">skip =</span> <span class="dv">1</span>)</code></pre>
<div id="inner-join" class="section level4">
<h4><span class="header-section-number">3.4.7.1</span> Inner join</h4>
<p>Prvo da vidimo inner join</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">inner_join</span>(superheroes, publishers, <span class="dt">by =</span> <span class="st">&quot;publisher&quot;</span>)</code></pre>
<pre><code>## # A tibble: 6 x 5
##   name     alignment gender publisher yr_founded
##   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;
## 1 Magneto  bad       male   Marvel          1939
## 2 Storm    good      female Marvel          1939
## 3 Mystique bad       female Marvel          1939
## 4 Batman   good      male   DC              1934
## 5 Joker    bad       male   DC              1934
## 6 Catwoman bad       female DC              1934</code></pre>
<p>Vidimo da fali Hellboy, jer Dark Horse Comics nije medju izdavačima u tabeli (a isto nema ni izdavača Image iz tabele izdavača, jer se ne pojavljuje medju herojima).</p>
</div>
<div id="left-join" class="section level4">
<h4><span class="header-section-number">3.4.7.2</span> Left join</h4>
<p>Kod left join operacije, čuvamo originalnu tabelu u celosti i uparujemo sa drugom gde je moguće</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">left_join</span>(superheroes, publishers, <span class="dt">by =</span> <span class="st">&quot;publisher&quot;</span>)</code></pre>
<pre><code>## # A tibble: 7 x 5
##   name     alignment gender publisher         yr_founded
##   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;                  &lt;dbl&gt;
## 1 Magneto  bad       male   Marvel                  1939
## 2 Storm    good      female Marvel                  1939
## 3 Mystique bad       female Marvel                  1939
## 4 Batman   good      male   DC                      1934
## 5 Joker    bad       male   DC                      1934
## 6 Catwoman bad       female DC                      1934
## 7 Hellboy  good      male   Dark Horse Comics         NA</code></pre>
<p>Sada kod Hellboy-a nemamo godinu osnivanja izdavača. jer ne postoji u tabeli.</p>
</div>
<div id="right-join" class="section level4">
<h4><span class="header-section-number">3.4.7.3</span> Right join</h4>
<p>Pogledajmo right join.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">right_join</span>(superheroes, publishers, <span class="dt">by =</span> <span class="st">&quot;publisher&quot;</span>)</code></pre>
<pre><code>## # A tibble: 7 x 5
##   name     alignment gender publisher yr_founded
##   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;
## 1 Batman   good      male   DC              1934
## 2 Joker    bad       male   DC              1934
## 3 Catwoman bad       female DC              1934
## 4 Magneto  bad       male   Marvel          1939
## 5 Storm    good      female Marvel          1939
## 6 Mystique bad       female Marvel          1939
## 7 &lt;NA&gt;     &lt;NA&gt;      &lt;NA&gt;   Image           1992</code></pre>
<p>Dodao je jedan red pun NA vrednosti, za izdavača Image, koji nije nadjen u prvoj tabeli. Svrha ove operacije je vrlo upitna, pa se retko i koristi.</p>
</div>
<div id="full-join" class="section level4">
<h4><span class="header-section-number">3.4.7.4</span> Full join</h4>
<p>Full join prikazuje sve redove i upisuje NA tamo gde nešto fali</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">full_join</span>(superheroes, publishers, <span class="dt">by =</span> <span class="st">&quot;publisher&quot;</span>)</code></pre>
<pre><code>## # A tibble: 8 x 5
##   name     alignment gender publisher         yr_founded
##   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;                  &lt;dbl&gt;
## 1 Magneto  bad       male   Marvel                  1939
## 2 Storm    good      female Marvel                  1939
## 3 Mystique bad       female Marvel                  1939
## 4 Batman   good      male   DC                      1934
## 5 Joker    bad       male   DC                      1934
## 6 Catwoman bad       female DC                      1934
## 7 Hellboy  good      male   Dark Horse Comics         NA
## 8 &lt;NA&gt;     &lt;NA&gt;      &lt;NA&gt;   Image                   1992</code></pre>
<p>Dakle imamo uniju left i right joina.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="1153-highcharter.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="21-mle.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
